---
title: "Portafolio Metodos Numericos"
author: "Flores Salazar Angel Rodrigo"
date: "r format(Sys,time(), ´%d,%B,%Y)"
output:
  html_document:                            
      toc: true
      toc_float: true
      toc:depth: 3
      code_folding: show
      theme: bootstrap
      word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(polynom)
```



# Sistemas de Punto Flotante

## Seccion 7.1 
======================

```{r}
## Ejercicio 7.1: conversion de base 10 a binario
### Numero 324
x <- 324
i <- floor(x)
f <- x - i
b <- c()
while(i > 0){
  b <- c(as.character(i %% 2), b)
  i <- i %/% 2
}
bin324 <- paste(b, collapse = "")
print(bin324)

# Numero 27
x <- 27
i <- floor(x)
f <- x - i
b <- c()
while(i > 0){
  b <- c(as.character(i %% 2), b)
  i <- i %/% 2
}
bin27 <- paste(b, collapse = "")
print(bin27)

# Numero 1423
x <- 1423
i <- floor(x)
f <- x - i
b <- c()
while(i > 0){
  b <- c(as.character(i %% 2), b)
  i <- i %/% 2
}
bin1423 <- paste(b, collapse = "")
print(bin1423)

# Numero 235.25
x <- 235.25
i <- floor(x)
f <- x - i
b <- c()
while(i > 0){
  b <- c(as.character(i %% 2), b)
  i <- i %/% 2
}
bf <- ""
for(k in 1:8){
  f <- f*2
  if(f >= 1){
    bf <- paste0(bf,"1")
    f <- f-1
  }else{
    bf <- paste0(bf,"0")
  }
}
bin235.25 <- paste0(paste(b,collapse=""),".",bf)
print(bin235.25)

# Numero 41.596
x <- 41.596
i <- floor(x)
f <- x - i
b <- c()
while(i > 0){
  b <- c(as.character(i %% 2), b)
  i <- i %/% 2
}
bf <- ""
for(k in 1:24){
  f <- f*2
  if(f >= 1){
    bf <- paste0(bf,"1")
    f <- f-1
  }else{
    bf <- paste0(bf,"0")
  }
}
bin41.596 <- paste0(paste(b,collapse=""),".",bf)
print(bin41.596)
```

## Seccion 7.2 
=========================


## Ejercicio 7.2.1 Historia de los Metodos Numericos "Investigacion"
### Introducción
Los métodos numéricos constituyen un conjunto de técnicas matemáticas utilizadas para resolver problemas de manera aproximada mediante procedimientos iterativos o algoritmos. Su desarrollo ha sido fundamental para la evolución de la ciencia y la ingeniería, permitiendo resolver problemas que, por su complejidad, no podían abordarse mediante cálculos exactos. La historia de los métodos numéricos refleja la evolución del pensamiento matemático y tecnológico a lo largo de los siglos.

### Orígenes en la Antigüedad
El uso de métodos aproximados se remonta a la Antigüedad. Civilizaciones como la babilónica y la egipcia desarrollaron procedimientos para realizar operaciones aritméticas, cálculo de áreas y volúmenes, y aproximaciones de raíces cuadradas. Los babilonios, por ejemplo, utilizaban tablas numéricas y algoritmos rudimentarios para resolver ecuaciones cuadráticas.  

En Grecia, matemáticos como Arquímedes realizaron aproximaciones geométricas para calcular el área de figuras y el valor de π. Su método de agotamiento es considerado un precursor del cálculo integral, ya que consistía en aproximar áreas mediante polígonos inscritos y circunscritos.

### Edad Media y Renacimiento
Durante la Edad Media, los métodos numéricos se desarrollaron lentamente debido a la limitada difusión del conocimiento matemático. Sin embargo, en el Renacimiento, el auge del comercio, la astronomía y la navegación impulsó la necesidad de cálculos más precisos. Matemáticos como Regiomontano y Cardano aplicaron técnicas para resolver ecuaciones algebraicas y cúbicas de manera aproximada.  

En el siglo XVII, con la aparición del cálculo por Newton y Leibniz, se formalizaron muchas técnicas que sentaron las bases de los métodos numéricos modernos, como el método de Newton-Raphson para encontrar raíces de ecuaciones.

### Siglo XVIII y XIX: Consolidación de los métodos
Durante los siglos XVIII y XIX, los métodos numéricos comenzaron a sistematizarse. Euler, Lagrange y Gauss realizaron contribuciones significativas. Euler desarrolló métodos para resolver ecuaciones diferenciales de manera aproximada, mientras que Gauss perfeccionó el método de eliminación para resolver sistemas de ecuaciones lineales, conocido hoy como eliminación de Gauss.  

Asimismo, se desarrollaron técnicas de interpolación, aproximación de funciones mediante polinomios y métodos para la integración numérica, que resultaron fundamentales para la física y la ingeniería.

### Siglo XX: La era de la computación
El siglo XX marcó un punto de inflexión en la historia de los métodos numéricos con la aparición de las computadoras electrónicas. Los algoritmos que antes requerían largos cálculos manuales pudieron implementarse en máquinas, aumentando la precisión y eficiencia de los resultados.  

En esta época, se desarrollaron métodos iterativos para resolver sistemas lineales grandes, técnicas avanzadas para la resolución de ecuaciones diferenciales parciales, y algoritmos de optimización y análisis numérico que hoy se aplican en campos tan diversos como la ingeniería, la economía, la biología computacional y la inteligencia artificial.

### Conclusión
La historia de los métodos numéricos es un reflejo de la evolución de la matemática aplicada y de la tecnología. Desde las aproximaciones geométricas de Arquímedes hasta los sofisticados algoritmos computacionales de la actualidad, estos métodos han sido esenciales para expandir nuestra capacidad de resolver problemas complejos y modelar fenómenos del mundo real. Su desarrollo continúa, adaptándose a nuevas necesidades y herramientas tecnológicas, consolidándose como una disciplina clave en la ciencia moderna.


## Ejercicio 7.2.2 - conversiones de varios numeros
```{r}

n <- c(246, 345.68, 4586632.2846, 984365.27463, 79905523)
for(num in n){
  x <- num
  i <- floor(x)
  f <- x - i
  b <- c()
  while(i > 0){
    b <- c(as.character(i %% 2), b)
    i <- i %/% 2
  }
  bf <- ""
  for(k in 1:30){
    f <- f*2
    if(f >= 1){
      bf <- paste0(bf,"1")
      f <- f-1
    }else{
      bf <- paste0(bf,"0")
    }
  }
  bin <- paste0(paste(b,collapse=""),".",bf)
  print(bin)
}
```

## Describe exhaustivamente los tipos de errores que existen

1.1. Usar cadenas no válidas como binarios
R no valida automáticamente si una cadena contiene solo 0 y 1.

1.2. Pasar objetos complejos cuando se espera texto o numéricos
Si se pasa una lista, data frame o factor en lugar de un string o número, R falla.

1.3. Factores convertidos implícitamente a enteros
Cuando un factor con niveles "0" y "1" se usa directamente, R convierte los niveles en enteros internos (1, 2, …).

2. Errores por rangos de valores (overflow/underflow)

2.1. Binarios demasiado largos para convertirse a integer
strtoi() trabaja con enteros de 32 bits. Si un binario excede ese rango (≈ 2^31), el resultado es NA.

2.2. Números decimales demasiado grandes antes de convertirlos
as.binary() de paquetes como binaryLogic también puede fallar por límites del tipo de dato.

3. Errores de función incorrecta o mal uso de funciones
3.1. Usar as.numeric() pensando que convierte a otra base

as.numeric() solo convierte tipos, NO hace conversiones de base.

3.2. Confundir strtoi() con funciones del paquete binaryLogic

Muchos personas mezclan funciones base de R con funciones externas

3.3Parámetros mal especificados

Por ejemplo, strtoi(x, base = 10, ...) cuando se pretendía base 2.

4. Errores de sintaxis (syntax errors)
Los errores de sintaxis ocurren cuando el código para convertir bases está mal escrito.

5. Errores al convertir números binarios negativos

R no interpreta el signo dentro del string del binario.

6. Errores de codificación o caracteres invisibles

Al copiar binarios desde archivos, páginas web o Excel:

6.1. Caracteres invisibles

Incluyen:
espacios
tabulaciones
saltos de línea
BOM UTF-8

7. Errores de interpretación (usar funciones conceptualmente incorrectas)
7.1. Intentar convertir números no enteros

8. Errores de lógica al construir binarios
Estos no arrojan errores en R, pero sí producen resultados incorrectos.

8.1. Invertir el orden de bits
Trabajar de derecha a izquierda o viceversa.

8.2. Usar divisiones enteras incorrectamente
Por ejemplo, usar 10 %/% 2 cuando se necesita 10 %% 2.


# Sistemas de Ecuaciones Lineales

# Seccion 7.3 
================

```{r}
## Ejercicio 7.3.1
gauss<- function(A, b, tol = 1e-12) {
  n <- nrow(A)
  M <- cbind(A,b)
  
  for (k in 1:(n-1)) {
    # Pivoteo parcial: buscar el máximo en la columna k desde fila k
    max_row <- which.max(abs(M[k:n, k])) + (k-1)
    if (abs(M[max_row, k]) < tol) stop("Matriz singular o pivote cero")
    if (max_row != k) M[c(k,max_row), ] <- M[c(max_row,k), ]
    
    for (i in (k+1):n) {
      factor <- M[i,k]/M[k,k]
      M[i,k:(n+1)] <- M[i,k:(n+1)] - factor*M[k,k:(n+1)]
    }
  }
  
  # Sustitución regresiva
  x <- numeric(n)
  for (i in n:1) {
    if (abs(M[i,i]) < tol) stop("Matriz singular en sustitución")
    x[i] <- (M[i,n+1] - sum(M[i,(i+1):n]*x[(i+1):n]))/M[i,i]
  }
  return(x)
}

# Ejemplo 7.3.1 seguro
A <- matrix(c(1, -2, 0.5,
              -2, 5, -1.5,
              -0.2, 1.75, -1),3,byrow=TRUE)
b <- c(-5,0,10)
gauss(A,b)

```

## Ejercicio 7.3.2
```{r}
A <- matrix(c(3, -1, 0, 6,
              4, 2, -1, -5,
              -5, 1, -3, 0,
              0, 10, -4, 7),4,byrow=TRUE)
b <- c(2.3,6.9,-36,-36)
cat("\n=== 7.3.2 ===\n")
gauss(A,b)

```

## Ejercicio 7.3.3
```{r}
.3
A <- matrix(c(0.003, 59.14,
              5.291, -6.13),2,byrow=TRUE)
b <- c(59.17,46.78)
cat("\n=== 7.3.3 ===\n")
gauss(A,b)
```

## Ejercicio 7.3.4
```{r}

A <- matrix(c(4,2,0,
              2,3,1,
              0,1,2.5),3,byrow=TRUE)
b <- c(2,-1,3)
n <- nrow(A)
M <- cbind(A,b)
for(k in 1:(n-1)){
  for(i in (k+1):n){
    f <- M[i,k]/M[k,k]
    M[i,k:ncol(M)] <- M[i,k:ncol(M)] - f*M[k,k:ncol(M)]
  }
}
x <- numeric(n)
for(i in n:1){
  x[i] <- (M[i,n+1]-sum(M[i,(i+1):n]*x[(i+1):n]))/M[i,i]
}
print(x)
```

## Ejercicio 7.3.5
```{r}
A <- matrix(c(3,-0.1,-0.2,
              0.1,7,-0.3,
              0.3,-0.2,10),3,byrow=TRUE)
b <- c(7.85,-19.3,71.4)
n <- nrow(A)
M <- cbind(A,b)
for(k in 1:(n-1)){
  for(i in (k+1):n){
    f <- M[i,k]/M[k,k]
    M[i,k:ncol(M)] <- M[i,k:ncol(M)] - f*M[k,k:ncol(M)]
  }
}
x <- numeric(n)
for(i in n:1){
  x[i] <- (M[i,n+1]-sum(M[i,(i+1):n]*x[(i+1):n]))/M[i,i]
}
print(x)
```

## Seccion 7.3.6
```{r}
A <- matrix(c(1,2,-1,
              2,1,1,
              1,-1,2),3,byrow=TRUE)
b <- c(4,5,6)
n <- nrow(A)
M <- cbind(A,b)
for(k in 1:(n-1)){
  for(i in (k+1):n){
    f <- M[i,k]/M[k,k]
    M[i,k:ncol(M)] <- M[i,k:ncol(M)] - f*M[k,k:ncol(M)]
  }
}
x <- numeric(n)
for(i in n:1){
  x[i] <- (M[i,n+1]-sum(M[i,(i+1):n]*x[(i+1):n]))/M[i,i]
}
print(x)
```

## Seccion 7.3.7 
```{r}
A <- matrix(c(2,1,-1,
              -3,-1,2,
              -2,1,2),3,byrow=TRUE)
b <- c(8,-11,-3)
n <- nrow(A)
M <- cbind(A,b)
for(k in 1:(n-1)){
  for(i in (k+1):n){
    f <- M[i,k]/M[k,k]
    M[i,k:ncol(M)] <- M[i,k:ncol(M)] - f*M[k,k:ncol(M)]
  }
}
x <- numeric(n)
for(i in n:1){
  x[i] <- (M[i,n+1]-sum(M[i,(i+1):n]*x[(i+1):n]))/M[i,i]
}
print(x)
```

## Seccion 7.3.8 
```{r}
A <- matrix(c(1,1,1,
              0,2,5,
              2,5,-1),3,byrow=TRUE)
b <- c(6,-4,27)
n <- nrow(A)
M <- cbind(A,b)
for(k in 1:(n-1)){
  for(i in (k+1):n){
    f <- M[i,k]/M[k,k]
    M[i,k:ncol(M)] <- M[i,k:ncol(M)] - f*M[k,k:ncol(M)]
  }
}
x <- numeric(n)
for(i in n:1){
  x[i] <- (M[i,n+1]-sum(M[i,(i+1):n]*x[(i+1):n]))/M[i,i]
}
print(x)
```

## Seccion 7.3.9 
```{r}
A <- matrix(c(4,-2,1,
              -2,4,-2,
              1,-2,3),3,byrow=TRUE)
b <- c(1,4,2)
n <- nrow(A)
M <- cbind(A,b)
for(k in 1:(n-1)){
  for(i in (k+1):n){
    f <- M[i,k]/M[k,k]
    M[i,k:ncol(M)] <- M[i,k:ncol(M)] - f*M[k,k:ncol(M)]
  }
}
x <- numeric(n)
for(i in n:1){
  x[i] <- (M[i,n+1]-sum(M[i,(i+1):n]*x[(i+1):n]))/M[i,i]
}
print(x)
```

## Seccion 7.3.10 
```{r}
A <- matrix(c(3,-1,2,
            1,0,1,
              4,2,-1),3,byrow=TRUE)
b <- c(5,2,7)
n <- nrow(A)
M <- cbind(A,b)
for(k in 1:(n-1)){
  for(i in (k+1):n){
    f <- M[i,k]/M[k,k]
    M[i,k:ncol(M)] <- M[i,k:ncol(M)] - f*M[k,k:ncol(M)]
  }
}
x <- numeric(n)
for(i in n:1){
  x[i] <- (M[i,n+1]-sum(M[i,(i+1):n]*x[(i+1):n]))/M[i,i]
}
print(x)
```

## Seccion 7.4 
=================

```{r}
gauss <- function(A, b, tol = .Machine$double.eps) {
  n <- nrow(A)
  M <- cbind(A, b)
  
  cat("Matriz inicial [A | b]:\n")
  print(round(M, 8)); cat("\n")
  
  for (k in 1:(n-1)) {
    # Pivoteo parcial
    i_max <- which.max(abs(M[k:n, k])) + k - 1
    if (abs(M[i_max, k]) < tol) stop(sprintf("Sistema singular en columna %d", k))
    if (i_max != k) {
      tmp <- M[k, ]; M[k, ] <- M[i_max, ]; M[i_max, ] <- tmp
      cat(sprintf("Intercambio de filas R%d <-> R%d\n", k, i_max))
      print(round(M, 6)); cat("\n")
    }
    
    # Eliminación
    p <- M[k,k]
    for (i in (k+1):n) {
      f <- M[i,k] / p
      M[i, k:(n+1)] <- M[i, k:(n+1)] - f * M[k, k:(n+1)]
      cat(sprintf("R%d <- R%d - (%.6g)*R%d\n", i, i, f, k))
      print(round(M, 6)); cat("\n")
    }
  }
  
  cat("Matriz triangular [U | c]:\n")
  print(round(M, 6)); cat("\n")
  
  # Sustitución regresiva
  x <- numeric(n)
  for (i in n:1) {
    s <- if (i < n) sum(M[i, (i+1):n] * x[(i+1):n]) else 0
    x[i] <- (M[i, n+1] - s) / M[i,i]
    cat(sprintf("x[%d] = (%.6g - %.6g)/%.6g = %.6g\n", i, M[i, n+1], s, M[i,i], x[i]))
  }
  
  cat("\nSolución x:\n")
  print(round(x, 6))
  
  r <- A %*% x - b
  cat("\nResiduo:\n")
  print(round(r, 6))
  
  list(x = x, resid = r, U = M)
}


# Ejercicio 7.4.1
cat("\n=== Ejercicio 7.4.1 ===\n")
A1 <- matrix(c(0.4, -1.5, 0.75,
               -0.5, -15, 10,
               -10, -9, 2.5), 3, byrow=TRUE)
b1 <- c(-20, -10, 30)
res1 <- gauss(A1, b1)
```

## Ejercicio 7.4.2
```{r}
cat("\n=== Ejercicio 7.4.2 ===\n")
A2 <- matrix(c(5, -8, 1,
               -2, 6, -9,
               3, -5, 2), 3, byrow = TRUE)
b2 <- c(-71, 134, -58)
res2 <- gauss(A2, b2)
```

## Ejercicio 7.4.3
```{r}
cat("\n=== Ejercicio 7.4.3 ===\n")
A3 <- matrix(c(0.003, 59.14,
               5.291, -6.130), 2, byrow = TRUE)
b3 <- c(59.17, 46.7)
res3 <- gauss(A3, b3)
```

## Ejercicio 7.4.4
```{r}
cat("\n=== Ejercicio 7.4.4 ===\n")
A4 <- matrix(c(0, -1, 4, -1,
               -1, 4, -1, 0,
               -1, 0, -1, 4,
               4, -1, 0, 0), 4, byrow = TRUE)
b4 <- c(-1, 2, 4, 10)
res4 <- gauss(A4, b4)
```

## Ejercicio 7.4.5
```{r}
cat("\n=== Ejercicio 7.4.5 ===\n")
A5 <- matrix(c(0.00031, 1.0,
               1.00045534, 1.00034333), 2, byrow = TRUE)
b5 <- c(3.0, 7.0)
res5 <- gauss(A5, b5)
```

## Ejercicio 7.4.6
```{r}
cat("\n=== Ejercicio 7.4.6 ===\n")
A6 <- matrix(c(14, 14, -9, 3, -5,
               14, 52, -15, 2, -32,
               -9, -15, 36, -5, 16,
               3, 2, -5, 47, 49,
               -5, 32, 16, 49, 79), 5, byrow = TRUE)
b6 <- c(-15, -100, 106, 329, 463)
res6 <- gauss(A6, b6)
```

## Ejercicio 7.4.7
```{r}
cat("\n=== Ejercicio 7.4.7 ===\n")
A7 <- matrix(c(1/4, 1/5, 1/6,
               1/4, 1/3, 1/5,
               1/2, 1,   2), 3, byrow = TRUE)
b7 <- c(9, 8, 8)
res7 <- gauss(A7, b7)
```

##Ejercicio 7.4.8
```{r}
cat("\n=== Ejercicio 7.4.8 ===\n")
A8 <- matrix(c(1, 1/2, 1/3, 1/4,
               1/2, 1/3, 1/4, 1/5,
               1/3, 1/4, 1/5, 1/6,
               1/4, 1/5, 1/6, 1/7), 4, byrow = TRUE)
b8 <- c(1/6, 1/7, 1/8, 1/9)
res8 <- gauss(A8, b8)


```

## Ejercicio 7.4.9
```{r}
cat("\n=== Ejercicio 7.4.9 ===\n")
A9 <- matrix(c(
  2,  1, -1,  1, -3,
  1,  0,  2, -1,  1,
  0, -2, -1,  1, -1,
  3,  1, -4,  0,  5,
  1, -1, -1, -1,  1
), nrow = 5, byrow = TRUE)
b9 <- c(7, 2, -5, 6, 3)
res9 <- gauss(A9, b9)
```

## Ejercicio 7.4.10
```{r}
cat("\n=== Ejercicio 7.4.10 ===\n")
A10 <- matrix(c(
  3.333, 15920, -10.333,
  2.222, 16.71, 0,
  1.5611, 5.1791, 1.6852
), nrow=3, byrow=TRUE)
b10 <- c(15913, 28.544, 8.4254)
res10 <- gauss(A10, b10)
```
## Seccion 7.5 Gauss-Jordan con pivoteo parcial

```{r}
## Función Gauss-Jordan con pivoteo parcial
gj <- function(A, b, tol = .Machine$double.eps){
  n <- nrow(A)
  M <- cbind(A,b)
  cat("matriz inicial:\n")
  print(round(M,8))
  
  for(i in 1:n){
    # Pivoteo parcial
    max_row <- which.max(abs(M[i:n, i])) + (i-1)
    if(max_row != i){
      tmp <- M[i,]
      M[i,] <- M[max_row,]
      M[max_row,] <- tmp
      cat(sprintf("\nIntercambiando fila %d con fila %d para pivoteo parcial\n", i, max_row))
      print(round(M,8))
    }
    
    pivot <- M[i,i]
    if(abs(pivot) < tol) stop("por si el pivote es pequeño.")
    
    # Normalizar fila
    M[i,] <- M[i,]/pivot
    cat(sprintf("\nNormalizando fila %d...\n",i))
    print(round(M,8))
    
    # Eliminar otras filas
    for(j in 1:n){
      if(j != i){
        factor <- M[j,i]
        M[j,] <- M[j,] - factor*M[i,]
        cat(sprintf("Actualizando fila %d usando fila %d...\n", j, i))
        print(round(M,8))
      }
    }
  }
  
  x <- M[,n+1]
  cat("\n¡Resultado final:\n")
  print(round(x,8))
  
  resid <- A %*% x - b
  cat("\nChequeando error (Ax-b):\n")
  print(round(resid,8))
  
  list(x=x, residual=resid, M_aug=M)
}

# Ejercicio 7.5.1
A <- matrix(c(1,2,3,
              -0.4,2,-1,
              0.5,-3,1),3,byrow=TRUE)
b <- c(1,10,15)
cat("=== Ejercicio 7.5.1 ===\n")
res <- gj(A,b)
```

## Ejercicio 7.5.2
```{r}

A <- matrix(c(2,-0.9,3,
              -0.5,0.1,-1,
              1,-6.35,-0.45),3,byrow=TRUE)
b <- c(-3.61,2.035,15.401)
cat("\n=== Ejercicio 7.5.2 ===\n")
res <- gj(A,b)
```

## Ejercicio 7.5.3
```{r}

A <- matrix(c(0.7,2.7,-6,0.7,
              2,-0.8,3,-1,
              -1,-1.5,1.4,3,
              0,7,-1.56,1),4,byrow=TRUE)
b <- c(1.6487,-2.342,-4.189,15.792)
cat("\n=== Ejercicio 7.5.3 ===\n")
res <- gj(A,b)

```

## Ejercicio 7.5.4
```{r}
A <- matrix(c(3,-0.1,-0.2,
              0.1,7,-0.3,
              0.3,-0.2,10),3,byrow=TRUE)
b <- c(7.85,-19.3,71.4)
cat("\n=== Ejercicio 7.5.4 ===\n")
res <- gj(A,b)
```

## Ejercicio 7.5.5
```{r}
A <- matrix(c(10,2,-1,
              -3,-6,2,
              1,1,5),3,byrow=TRUE)
b <- c(27,-61.5,-21.5)
cat("\n=== Ejercicio 7.5.5 ===\n")
res <- gj(A,b)
```

##Ejercicio 7.5.6
```{r}

A <- matrix(c(1,3,-2,1,
              1,3,-1,2,
              0,1,-1,4,
              2,6,1,2),4,byrow=TRUE)
b <- c(4,1,5,2)
cat("\n=== Ejercicio 7.5.6 ===\n")
res <- gj(A,b)
```

## Ejercicio 7.5.7
```{r}
A <- matrix(c(6,-1,-1,4,
              1,-10,2,-1,
              3,-2,8,-1,
              1,1,1,-5),4,byrow=TRUE)
b <- c(17,-17,19,-14)
cat("\n=== Ejercicio 7.5.7 ===\n")
res <- gj(A,b)
```

## Ejercicio 7.5.8
```{r}
A <- matrix(c(1,2,3,4,
              1,-4,1,11,
              -1,8,7,6,
              16,8,-5,6),4,byrow=TRUE)
b <- c(1,2,-2,11)
cat("\n=== Ejercicio 7.5.8 ===\n")
res <- gj(A,b)
```

## Ejercicio 7.5.9
```{r}

A <- matrix(c(1,1,0,0,0,
              1,2,1,0,0,
              0,1,3,1,0,
              0,0,1,4,1,
              0,0,0,1,5),5,byrow=TRUE)
b <- c(3,-1,2,1,3)
cat("\n=== Ejercicio 7.5.9 ===\n")
res <- gj(A,b)
```

## Ejercicio 7.5.10
```{r}
A <- matrix(c(15,-18,15,-3,
              -18,2,-18,4,
              15,-18,18,-3,
              -3,4,-3,1),4,byrow=TRUE)
b <- c(11,10,11,13)
cat("\n=== Ejercicio 7.5.10 ===\n")
res <- gj(A,b)
```

## Seccion 7.6 Gauss-Seidel

```{r}
gauss_seidel <- function(A, b, x_init = NULL, tol = 1e-10, maxit = 200, verbose = TRUE, verbose_every = 1){
  n <- nrow(A)
  x <- if(is.null(x_init)) rep(0, n) else x_init
  
  if(verbose) cat("Vector inicial x:\n"); print(round(x,8))
  
  for(k in 1:maxit){
    x_old <- x
    for(i in 1:n){
      # Reordenar filas si pivote cero
      if(abs(A[i,i]) < 1e-15){
        swap_row <- which(abs(A[i:n,i]) > 1e-15)[1] + (i-1)
        if(is.na(swap_row)){
          stop(sprintf("No se puede resolver, pivote cero en columna %d.", i))
        }
        cat(sprintf("\nIntercambiando fila %d con fila %d para evitar pivote cero\n", i, swap_row))
        tmp <- A[i,]; A[i,] <- A[swap_row,]; A[swap_row,] <- tmp
        tmpb <- b[i]; b[i] <- b[swap_row]; b[swap_row] <- tmpb
        if(verbose) print(cbind(A,b))
      }
      
      s1 <- if(i>1) sum(A[i,1:(i-1)]*x[1:(i-1)]) else 0
      s2 <- if(i<n) sum(A[i,(i+1):n]*x_old[(i+1):n]) else 0
      x[i] <- (b[i]-s1-s2)/A[i,i]
      
      if(verbose & (k %% verbose_every == 0)){
        cat(sprintf("Actualizando x[%d] = %.8f\n", i, x[i]))
      }
    }
    
    err <- sqrt(sum((x-x_old)^2))
    if(is.na(err)){ cat(sprintf("Error en iteración %d: NA detectado\n", k)); break }
    if(verbose & (k %% verbose_every == 0)){
      cat(sprintf("Error en iteración %d: %.12f\n", k, err))
    }
    if(err<tol){ if(verbose) cat("¡Convergencia alcanzada!\n"); break }
  }
  
  if(verbose){
    cat("\nResultado final x:\n")
    print(round(x,8))
    resid <- A %*% x - b
    cat("\nChequeando residuo (Ax-b):\n")
    print(round(resid,8))
  } else {
    resid <- A %*% x - b
  }
  
  list(x=x, residual=resid)
}
```

## 7.6.1
```{r}
A <- matrix(c(3,-0.2,-0.5,
              0.1,7,0.4,
              0.4,-0.1,10),3,byrow=TRUE)
b <- c(8,-19.5,72.4)
cat("=== Ejercicio 7.6.1 ===\n")
res <- gauss_seidel(A,b, verbose=TRUE)

```

## 7.6.2 
```{r}
A <- matrix(c(-5,1.4,-2.7,
              0.7,-2.5,15,
              3.3,-11,4.4),3,byrow=TRUE)
b <- c(94.2,-6,-27.5)
cat("\n=== Ejercicio 7.6.2 (iteración de 5 en 5) ===\n")
res <- gauss_seidel(A,b, verbose=TRUE, verbose_every=5)
```

## 7.6.3
```{r}
A <- matrix(c(3,-0.5,0.6,
              0.3,-4,-1,
              -0.7,2,7),3,byrow=TRUE)
b <- c(5.24,-0.387,14.803)
cat("\n=== Ejercicio 7.6.3 ===\n")
res <- gauss_seidel(A,b, verbose=TRUE)



```

## 7.6.4
```{r}
A <- matrix(c(5,-0.2,1,
              0.1,3,-0.5,
              -0.3,1,-7),3,byrow=TRUE)
b <- c(1.5,-2.7,9.5)
cat("\n=== Ejercicio 7.6.4 ===\n")
res <- gauss_seidel(A,b, verbose=TRUE)
```

## 7.6.5 
```{r}
A <- matrix(c(0,-3,7,
              1,2,-1,
              12,2,2),3,byrow=TRUE)
b <- c(2,3,6)
cat("\n=== Ejercicio 7.6.5 (iteración de 5 en 5) ===\n")
res <- gauss_seidel(A,b, verbose=TRUE, verbose_every=5)
```

## 7.6.6
```{r}
A <- matrix(c(0.151,2.11,30.75,
              0.64,1.21,2.05,
              3.21,1.53,1.04),3,byrow=TRUE)
b <- c(-26.38,1.01,5.23)
cat("\n=== Ejercicio 7.6.6 (iteración de 5 en 5) ===\n")
res <- gauss_seidel(A,b, verbose=TRUE, verbose_every=5)
```

## 7.6.7
```{r}
A <- matrix(c(1,1,-1,
              6,2,2,
              -3,4,1),3,byrow=TRUE)
b <- c(-3,2,1)
cat("\n=== Ejercicio 7.6.7 (iteración de 5 en 5) ===\n")
res <- gauss_seidel(A,b, verbose=TRUE, verbose_every=5)
```

## 7.6.8
```{r}
A <- matrix(c(2,1,-1,
              5,2,2,
              3,1,1),3,byrow=TRUE)
b <- c(1,-4,5)
cat("\n=== Ejercicio 7.6.8 ===\n")
res <- gauss_seidel(A,b, verbose=TRUE)
```

## 7.6.9
```{r}
A <- matrix(c(3,-0.1,-0.2,
              0.1,7,-0.3,
              0.3,-0.2,10),3,byrow=TRUE)
b <- c(7.85,-19.3,71.4)
cat("\n=== Ejercicio 7.6.9 ===\n")
res <- gauss_seidel(A,b, verbose=TRUE)
```

## 7.6.10
```{r}
A <- matrix(c(17,-2,-3,
              -5,21,-2,
              -5,-5,22),3,byrow=TRUE)
b <- c(500,200,30)
cat("\n=== Ejercicio 7.6.10 ===\n")
res <- gauss_seidel(A,b, verbose=TRUE)
```

## Seccion 7.7 Método de Jacobi

```{r}
jacobi <- function(A, b, x_init = NULL, tol = 1e-10, maxit = 200, verbose = TRUE, verbose_every = 1){
  n <- nrow(A)
  x <- if(is.null(x_init)) rep(0, n) else x_init
  x_new <- x
  
  if(verbose) cat("Vector inicial x:\n"); print(round(x,8))
  
  for(k in 1:maxit){
    for(i in 1:n){
      s <- sum(A[i,-i]*x[-i])
      if(abs(A[i,i]) < 1e-15) stop(sprintf("Pivote cero en fila %d", i))
      x_new[i] <- (b[i] - s)/A[i,i]
    }
    
    err <- sqrt(sum((x_new - x)^2))
    if(err < tol){
      if(verbose) cat(sprintf("¡Convergencia alcanzada en %d iteraciones!\n", k))
      x <- x_new
      break
    }
    
    x <- x_new
    
    if(verbose & (k %% verbose_every == 0)){
      cat(sprintf("Iteración %d: x = %s, error = %.12f\n", k, paste(round(x,5), collapse=", "), err))
    }
  }
  
  if(verbose){
    cat("\nResultado final x:\n"); print(round(x,8))
    resid <- A %*% x - b
    cat("\nChequeando residuo (Ax-b):\n"); print(round(resid,8))
  } else {
    resid <- A %*% x - b
  }
  
  list(x=x, residual=resid)
}

```

## 7.7.1 (4x4)
```{r}
A <- matrix(c(10,2,-1,0,
              1,20,-2,3,
             -2,1,30,0,
              1,2,3,20),4,byrow=TRUE)
b <- c(26,-15,53,47)
cat("\n=== Ejercicio 7.7.1 ===\n")
res <- jacobi(A,b, verbose=TRUE)
```

## 7.7.2 (3x3)
```{r}
A <- matrix(c(-1,2,10,
              11,-1,2,
               1,5,2),3,byrow=TRUE)
b <- c(11,12,8)
cat("\n=== Ejercicio 7.7.2 ===\n")
res <- jacobi(A,b, verbose=TRUE)
```

## 7.7.3 (3x3)
```{r}
A <- matrix(c(8,2,3,
              2,5,1,
             -3,1,6),3,byrow=TRUE)
b <- c(51,23,20)
cat("\n=== Ejercicio 7.7.3 ===\n")
res <- jacobi(A,b, verbose=TRUE)
```

## 7.7.4 (4x4)
```{r}
A <- matrix(c(2,-1,1,3,
              2,2,2,2,
             -1,-1,2,2,
              3,1,-1,4),4,byrow=TRUE)
b <- c(10,1,-5,6)
cat("\n=== Ejercicio 7.7.4 ===\n")
res <- jacobi(A,b, verbose=TRUE)
```

## 7.7.5 (4x4)
```{r}
A <- matrix(c(3,1,1,-1,
              0,2,1,4,
              1,1,-1,9,
              2,4,6,3),4,byrow=TRUE)
b <- c(5,0,1,0)
cat("\n=== Ejercicio 7.7.5 ===\n")
res <- jacobi(A,b, verbose=TRUE)
```

## 7.7.6 (4x4)
```{r}
A <- matrix(c(10,-1,2,0,
             -1,11,-1,3,
              2,-1,10,-1,
              0,2,-1,8),4,byrow=TRUE)
b <- c(6,25,-11,15)
cat("\n=== Ejercicio 7.7.6 ===\n")
res <- jacobi(A,b, verbose=TRUE)
```

## 7.7.7 (3x3)
```{r}
A <- matrix(c(1,2,-2,
              1,1,1,
              2,2,1),3,byrow=TRUE)
b <- c(7,2,5)
cat("\n=== Ejercicio 7.7.7 (iteración cada 5) ===\n")
res <- jacobi(A,b, verbose=TRUE, verbose_every=5)
```

## 7.7.8 (3x3)
```{r}
A <- matrix(c(-4,14,0,
              -5,13,0,
              -1,0,2),3,byrow=TRUE)
b <- c(10,8,1)
cat("\n=== Ejercicio 7.7.8 (iteración cada 5) ===\n")
res <- jacobi(A,b, verbose=TRUE, verbose_every=5)
```

## 7.7.9 (3x3)
```{r}
A <- matrix(c(1,1,2,
              1,2,1,
              2,1,1),3,byrow=TRUE)
b <- c(1,1,1)
cat("\n=== Ejercicio 7.7.9 ===\n")
res <- jacobi(A,b, verbose=TRUE)
```

## 7.7.10 (4x4)
```{r}
A <- matrix(c(6,-2,2,4,
              12,-8,6,10,
               3,-13,9,3,
              -6,4,1,-18),4,byrow=TRUE)
b <- c(10,20,2,-19)
cat("\n=== Ejercicio 7.7.10 (iteración cada 5) ===\n")
res <- jacobi(A,b, verbose=TRUE, verbose_every=5)
```

## Ejercicio 7.8 

Por indicaciones del Profesor esta seccion no se realiza



# Raíces de funciones

## Funciones auxiliares

```{r funciones-aux}
biseccion <- function(f, a, b, n_iter = 8, tol = 1e-12) {
  fa <- f(a); fb <- f(b)
  if (fa * fb >= 0) stop("El intervalo inicial no cumple f(a)*f(b) < 0")

  hist <- data.frame(
    k = integer(), a = numeric(), b = numeric(), c = numeric(),
    fa = numeric(), fb = numeric(), fc = numeric(),
    signo = character(), error = numeric(), stringsAsFactors = FALSE
  )

  for (k in 1:n_iter) {
    c <- (a + b) / 2
    fc <- f(c)
    signo <- ifelse(fa * fc < 0, "fa*fc < 0", "fa*fc > 0")

    hist[k,] <- list(k, a, b, c, fa, fb, fc, signo, abs(b - a))

    if (abs(fc) < tol) break
    if (fa * fc < 0) { b <- c; fb <- fc } else { a <- c; fa <- fc }
  }
  list(hist = hist, raiz = (a + b)/2, error_cota = abs(b-a)/2)
}

grafica_biseccion <- function(f, hist, titulo=NULL){
  xs <- seq(min(hist$a), max(hist$b), length.out=400)
  df <- data.frame(x=xs, y=sapply(xs, f))
  ggplot(df, aes(x,y)) +
    geom_line() + geom_hline(yintercept=0, linetype="dashed") +
    ggtitle(titulo)
}

secante <- function(f, x0, x1, n_iter = 12, tol = 1e-5){
  hist <- data.frame(
    k = integer(), x_prev=numeric(), x_curr=numeric(),
    f_curr=numeric(), x_next=numeric(), error=numeric()
  )
  for(k in 1:n_iter){
    f0 <- f(x0); f1 <- f(x1)
    if(abs(f1 - f0) < 1e-14) stop("División por cero en secante")

    x2 <- x1 - f1 * (x1 - x0) / (f1 - f0)
    hist[k,] <- list(k, x0, x1, f1, x2, abs(x2 - x1))

    if(abs(x2 - x1) < tol) break
    x0 <- x1; x1 <- x2
  }
  list(hist=hist, raiz=x2)
}
```

#### Seccion 1.3 — Bisección

```{r punto-1.3}
f1_1 <- function(x) x^3 - 6*x + 2
f1_2 <- function(x) exp(-x) - x
f1_3 <- function(x) x^2 - 4

casos <- list(
  list(f=f1_1, a=0, b=2, n=12, nombre="x^3 - 6x + 2"),
  list(f=f1_2, a=0, b=1, n=12, nombre="exp(-x) - x"),
  list(f=f1_3, a=-1, b=4, n=12, nombre="x^2 - 4")
)

for(i in seq_along(casos)){
  caso <- casos[[i]]
  res <- biseccion(caso$f, caso$a, caso$b, caso$n)

  cat("\n###### Ejercicio 1.3:", caso$nombre, "\n")

  tabla <- res$hist
  tabla[, sapply(tabla, is.numeric)] <- round(tabla[, sapply(tabla, is.numeric)], 8)
  print(tabla)

  print(grafica_biseccion(caso$f, res$hist, caso$nombre))
}
```

#### Seccion 5.1 — Bisección

```{r punto-5.1}
f_list_5_1 <- list(
  list(f=function(x) x^2 - 5, a=2, b=3, nombre="x^2 - 5")
)

for(i in seq_along(f_list_5_1)){
  caso <- f_list_5_1[[i]]

  res <- try(biseccion(caso$f, caso$a, caso$b, 8), silent=TRUE)
  if(inherits(res, "try-error")){
    cat("\nError en:", caso$nombre, "\n")
    next
  }

  cat("\n###### 5.1:", caso$nombre, "\n")
  tabla <- res$hist
  tabla[, sapply(tabla, is.numeric)] <- round(tabla[, sapply(tabla, is.numeric)], 8)
  print(tabla)
  print(grafica_biseccion(caso$f, res$hist, caso$nombre))
}
```

#### Seccion 5.2 — Secante

```{r punto-5.2}
f_list_5_2 <- list(
  list(f=function(x) x^2 - 2*x -3, x0=0, x1=3, nombre="x^2 - 2x -3")
)

for(i in seq_along(f_list_5_2)){
  caso <- f_list_5_2[[i]]

  res <- try(secante(caso$f, caso$x0, caso$x1), silent=TRUE)
  if(inherits(res, "try-error")){
    cat("\nError en:", caso$nombre, "\n")
    next
  }

  cat("\n###### 5.2:", caso$nombre, "\n")
  tabla <- res$hist
  tabla[, sapply(tabla, is.numeric)] <- round(tabla[, sapply(tabla, is.numeric)], 8)
  print(tabla)
}
```

## 1.6 Tarea para el portafolio

## 1. Método de Bisección

#### Función general

``` {r}
biseccion <- function(f, a, b, n){
  datos <- data.frame(
    iter = 1:n,
    a = NA, b = NA, xm = NA,
    fa = NA, fb = NA, fxm = NA,
    error = NA
  )

  for(i in 1:n){
    xm <- (a + b) / 2
    fa <- f(a)
    fb <- f(b)
    fxm <- f(xm)

    datos$a[i] <- a
    datos$b[i] <- b
    datos$xm[i] <- xm
    datos$fa[i] <- fa
    datos$fb[i] <- fb
    datos$fxm[i] <- fxm

    if(i > 1){
      datos$error[i] <- abs(datos$xm[i] - datos$xm[i-1])
    }

    if(fa * fxm < 0){
      b <- xm
    } else {
      a <- xm
    }
  }

  return(datos)
}
```


## 2. Método de la Secante

``` {r}
secante <- function(f, x0, x1, n){
  datos <- data.frame(
    iter = 1:n,
    x0 = NA, x1 = NA, x2 = NA,
    fx0 = NA, fx1 = NA,
    error = NA
  )

  for(i in 1:n){
    fx0 <- f(x0)
    fx1 <- f(x1)
    x2 <- x1 - fx1 * (x1 - x0) / (fx1 - fx0)

    datos$x0[i] <- x0
    datos$x1[i] <- x1
    datos$x2[i] <- x2
    datos$fx0[i] <- fx0
    datos$fx1[i] <- fx1

    if(i > 1){
      datos$error[i] <- abs(datos$x2[i] - datos$x2[i-1])
    }

    x0 <- x1
    x1 <- x2
  }

  return(datos)
}
```


## 3. Método de Newton

``` {r}
newton <- function(f, df, x0, n){
  datos <- data.frame(
    iter = 1:n,
    x = NA, fx = NA, dfx = NA,
    x_new = NA,
    error = NA
  )

  for(i in 1:n){
    fx <- f(x0)
    dfx <- df(x0)
    x_new <- x0 - fx / dfx

    datos$x[i] <- x0
    datos$fx[i] <- fx
    datos$dfx[i] <- dfx
    datos$x_new[i] <- x_new

    if(i > 1){
      datos$error[i] <- abs(datos$x_new[i] - datos$x_new[i-1])
    }

    x0 <- x_new
  }

  return(datos)
}
```


## 4. Método del Punto Fijo

``` {r}
punto_fijo <- function(g, x0, n){
  datos <- data.frame(
    iter = 1:n,
    x = NA, gx = NA,
    error = NA
  )

  for(i in 1:n){
    gx <- g(x0)

    datos$x[i] <- x0
    datos$gx[i] <- gx

    if(i > 1){
      datos$error[i] <- abs(datos$gx[i] - datos$gx[i-1])
    }

    x0 <- gx
  }

  return(datos)
}
```



## 5. Ejemplos de ejecución

### Ejemplo Bisección

``` {r}
f <- function(x) x^2 - 5
biseccion(f, 2, 3, 8)
```

### Ejemplo Secante

``` {r}
f <- function(x) x^2 - 5
secante(f, 1, 3, 8)
```

### Ejemplo Newton

``` {r}
f <- function(x) x^2 - 5
df <- function(x) 2*x
newton(f, df, 3, 8)
```

### Ejemplo Punto Fijo

``` {r}
g <- function(x) sqrt(5)
punto_fijo(g, 1, 8)
```

# Interpolación

## Ejercicio 1 – Punto 2 y Punto 3

### Punto 2: Newton y Tabla de Diferencias

```{r}
x <- c(1, 2, 3, 4)
y <- c(2, 5, 10, 17)

tabla_dif <- function(x, y) {
  n <- length(x)
  T <- matrix(0, n, n)
  T[,1] <- y
  for(j in 2:n){
    for(i in 1:(n-j+1)){
      T[i,j] <- (T[i+1,j-1] - T[i,j-1]) / (x[i+j-1] - x[i])
    }
  }
  return(T)
}
T <- tabla_dif(x, y)
T

newton_eval <- function(x, T, xv){
  n <- length(x)
  p <- T[1,1]
  mult <- 1
  for(j in 2:n){
    mult <- mult * (xv - x[j-1])
    p <- p + T[1,j] * mult
  }
  return(p)
}
p25 <- newton_eval(x, T, 2.5)
p25

f_exacta <- function(x){ x^2 + 1 }
data.frame(P_Interpolado = p25, Exacto = f_exacta(2.5))
```

### Punto 3: Polinomio de Lagrange

```{r}
x <- c(-1, 0, 2)
y <- c(4, 1, 3)

lagrange_eval <- function(x, y, xv){
  n <- length(x)
  P <- 0
  for(i in 1:n){
    L <- 1
    for(j in 1:n){
      if(j != i){
        L <- L * (xv - x[j])/(x[i] - x[j])
      }
    }
    P <- P + y[i] * L
  }
  return(P)
}

P <- polynomial(0)
for(i in 1:3){
  L <- polynomial(1)
  for(j in 1:3){
    if(i != j){
      L <- L * polynomial(c(-x[j],1))/(x[i]-x[j])
    }
  }
  P <- P + y[i]*L
}
P

c(P_menos1=predict(P,-1), P_0=predict(P,0), P_2=predict(P,2))
```

## Ejercicio 2 Completo

### 2.1 Diferencias progresivas y Newton hacia adelante

```{r}
x1 <- c(0,1,2,3,4)
y1 <- c(1,2,4,8,16)

tabla_prog <- function(y){
  n <- length(y)
  T <- matrix(0,n,n)
  T[,1] <- y
  for(j in 2:n){
    for(i in 1:(n-j+1)){
      T[i,j] <- T[i+1,j-1] - T[i,j-1]
    }
  }
  return(T)
}

TP <- tabla_prog(y1)
TP

newton_forward <- function(x, y, xv){
  h <- x[2]-x[1]
  T <- tabla_prog(y)
  s <- (xv-x[1])/h
  n <- length(x)
  P <- y[1]
  coef <- 1
  for(k in 1:(n-1)){
    coef <- coef * (s-(k-1))
    P <- P + coef*T[1,k+1]/factorial(k)
  }
  return(P)
}

newton_forward(x1,y1,2.5)
2^2.5
```

## 2.2 Diferencias regresivas y Newton hacia atrás

```{r}
x2 <- c(1,2,3,4)
y2 <- c(1,8,27,64)

tabla_back <- function(y){
  n <- length(y)
  T <- matrix(0,n,n)
  T[,1] <- y
  for(j in 2:n){
    for(i in j:n){
      T[i,j] <- T[i,j-1] - T[i-1,j-1]
    }
  }
  return(T)
}

TB <- tabla_back(y2)
TB

newton_back <- function(x,y,xv){
  h <- x[2]-x[1]
  T <- tabla_back(y)
  n <- length(x)
  s <- (xv - x[n])/h
  P <- y[n]
  coef <- 1
  for(k in 1:(n-1)){
    coef <- coef*(s+(k-1))
    P <- P + coef*T[n,k+1]/factorial(k)
  }
  return(P)
}

newton_back(x2,y2,3.4)
3.4^3
```

## 2.3 Datos experimentales – Progresivas y estimación

```{r}
x3 <- c(10,20,30,40,50)
y3 <- c(20.5,24.0,32.0,42.5,51.0)

diff(x3)

TP3 <- tabla_prog(y3)
TP3

newton_forward(x3,y3,25)
```

## Ejercicio 3 – Polinomio General Interpolante

```{r}
interp_general <- function(x, y){
  P <- polynomial(0)
  n <- length(x)
  for(i in 1:n){
    L <- polynomial(1)
    for(j in 1:n){
      if(j!=i){
        L <- L*polynomial(c(-x[j],1))/(x[i]-x[j])
      }
    }
    P <- P + y[i]*L
  }
  return(P)
}

P1 <- interp_general(c(0,1,2), c(1,3,11))
P2 <- interp_general(c(1,2,3,4), c(2,5,10,17))
P3 <- interp_general(c(-1,0,2), c(4,1,3))
P4 <- interp_general(c(0,1,2,3,4), c(2.0,2.7,4.8,8.9,16.0))

P1; P2; P3; P4
```

## EJERCICIO 3 – Polinomio interpolante general (Lagrange sin librerías)

```{r}
lagrange_poly <- function(x,y,xv){
  n <- length(x)
  P <- 0
  for(i in 1:n){
    L <- 1
    for(j in 1:n){
      if(i!=j){
        L <- L * (xv - x[j])/(x[i]-x[j])
      }
    }
    P <- P + y[i]*L
  }
  return(P)
}

xA <- c(0,1,2); yA <- c(1,3,11)
xB <- c(1,2,3,4); yB <- c(2,5,10,17)
xC <- c(-1,0,2); yC <- c(4,1,3)
xD <- c(0,1,2,3,4); yD <- c(2.0,2.7,4.8,8.9,16.0)

lagrange_poly(xA,yA,1.5)
lagrange_poly(xC,yC,0)
```

## EJERCICIO 4 – Datos equiespaciados (h = 10)

```{r}
x4 <- c(10,20,30,40,50)
y4 <- c(20.5,24.0,32.0,42.5,51.0)

TP4 <- tabla_prog(y4)
TP4

newton_forward(x4,y4,25)
```

# Practicas de laboratorio

## Matriz
```{r}
Descriminante <- function(a,b,c){
  soluciones <- b^2-4*a*c
  if (soluciones<0){
    resp <- "No hay solucion"
  } else{
    resp <- "Si hay solucion" 
  }
  respuesta <- cat(resp," ", soluciones)
  return(respuesta)
}
```

```{r}
intento1 <- Descriminante(5,2,3)
print(intento1)
```

```{r}
valores <- c(15, 13, 8, 3, 27, -4, -2, 10, 11)
A <- matrix(valores, nrow = 3); print(A)
tA <- matrix(t(valores), nrow = 3); print(tA)
valores2 <- c(15,3,-2,13,27,10,8,-4,11)
A2 <- matrix(valores2, nrow = 3); print(A2)
b <- matrix(c(3,2,-1), nrow = 3); print(b)
Ab <- cbind(A,b); print(Ab)
bA <- cbind(b,A); print(bA)
Abt <-rbind(A,t(b)); print(Abt)
btA <-rbind(t(b),A); print(btA)
```

```{r}
r1 <- Ab[1,]; print(r1)
r2 <- -Ab[2,]; print(r2)
r3 <- Ab[3,]; print(r3)
c1 <- Ab[,1]; print(c1)
c2 <- Ab[,2]; print(c2)
c3 <- Ab[,3];print(c3)
a11 <- Ab[1,1]; print(a11)
a22 <- Ab[2,2]; print(a22)
a32 <- Ab[3,2]; print(a32)
a23 <- Ab[2,3]; print(a23)
a14 <- Ab[1,4]; print(a14)
```
## Eliminacion Gaussiana Simple
```{r}
m1 <- -Ab[2,1]/Ab[1,1]; print(m1)
m2 <- Ab[3,1]/Ab[1,1]; print(m2)
A1 <- Ab[1,]; print(A1)
A2 <- m1*Ab[1,]+Ab[2,]; print(A2)
A3 <-m2*Ab[1,]+Ab[3,]; print(A3)
NuevaA <- rbind(A1, A2, A3); (NuevaA)
```

## Raices de funciones
```{r}
N <- 1000
a <- -5
b <- 5
paso <- 0.01
x <- seq(a, b, paso)
head(x,10)
```

Graficamos la funcion $f(x)=-x^^{3}-6x^{2}+11x-6$
```{r}
A <- 2
B <- -3
C <- -11
D <- 6

f_x <- A*x^3+B*x^2+C*x+D
head(f_x, 10)

```

Graficamos la funcion
```{r}
plot(x, f_x, col ="blue",
     type ="l",
     main="Grafica de una funcion cubica",
     xlab="x",
     ylab= "f(x)")
abline(v = 0, type="-", col="gray")
abline(h = 0, type="-", col="gray")
```

Busqueda de las raiz, depues de revisar la grafica en el intervalo $[-9,-5]$
```{r}
a <- -9
b <- -5
```



Empezamos con el metodo de biseccion $c=\frac{a+b}{2}$
```{r}
c <- (a+b)/2;
print(c)
```

Definimos la funcion \textit{fcubica} para evaluar nuetra cubica en los puntos de interes
```{r}
f_cubica <- function(x){A*x^3+B*x^2+C*x+D}
```

Probemos la funcion, en R, en los putnso $a$ y $b$
```{r}
fa <- f_cubica(a); print(fa)
fb <- f_cubica(b); print(fb)
fc <- f_cubica(c); print(fc)
```


```{r}
signo_fafc <- sign(fa*fc); print(signo_fafc)
signo_fbfc <- sign(fb*fc); print(signo_fbfc)
```



como $fa*fc<0$ hacemos la asignacion $b\leftarrow c$, y cañcilamos el nuevo valor de $c$
```{r}
b <- c
c <- (a+b)/2; print(c)
```

Evaluamos nuevamente la cubica de en $a,b$ y $c$

```{r}
fa <- f_cubica(a); print(fa)
fb <- f_cubica(b); print(fb)
fc <- f_cubica(c); print(fc)
signo_fafc <- sign(fa*fc); print(signo_fafc)
signo_fbfc <- sign(fb*fc); print(signo_fbfc)
```

Como el signo fue nefatuvo para $fb*fc<0$ y $fa-fc>0$, entonces hacemos la asignacion $a\leftarrow c$
```{r}
a <- c; print(c)
c <- (a+b)/2; print(c)
```

Evaluamos nuevamente la cubica en $a,b$ y $c$
```{r}
fa <- f_cubica(a); print(fa)
fb <- f_cubica(b); print(fb)
fc <- f_cubica(c); print(fc)
signo_fafc <- sign(fa*fc); print(signo_fafc)
signo_fbfc <- sign(fb*fc); print(signo_fbfc)
```

## Ejemplo 1 

Fraficar la funcion $f(x)=2x^{3}-3x^{2}-11x+6$ en el intervalo $\left[-10,10\rigtht]$
```{r}
A <- 2
B <- -3
C <- -11
D <- 6
```

```{r}
A <- 2
B <- -3
C <- -11
D <- 6


f_secante <- function(x0, x1) {
  fx0 <- A*x0^3 + B*x0^2 + C*x0 + D
  fx1 <- A*x1^3 + B*x1^2 + C*x1 + D
  
  # Fórmula del método de la secante
  x2 <- x1 - fx1 * (x1 - x0) / (fx1 - fx0)
  
  return(list(x2 = x2, fx0 = fx0, fx1 = fx1))
}
r <- f_secante(0, 3)
print(r)

```
## Metodos Iterativos

### Metodo de la secante
```{r}
# Configuración inicial
knitr::opts_chunk$set(echo = TRUE)

N <- 1000
a <- -10
b <- 10
paso <- 0.01
x <- seq(a, b, paso)
head(x,10)

# Graficamos la funcion f(x)=-x^3-6x^2+11x-6
A <- 2
B <- -3
C <- -11
D <- 6

f_x <- A*x^3 + B*x^2 + C*x + D
head(f_x, 10)

# Graficamos la función
plot(x, f_x, col ="blue",
     type ="l",
     main="Grafica de una funcion cubica",
     xlab="x",
     ylab= "f(x)")
abline(v = 0, col="gray")
abline(h = 0, col="gray")

# Busqueda de la raiz, después de revisar la grafica en el intervalo [-9,-5]
a <- -9
b <- -5

# Metodo de biseccion c=(a+b)/2
c <- (a+b)/2
print(c)

# Definimos la función cúbica
f_cubica <- function(x){A*x^3 + B*x^2 + C*x + D}

# Probamos la función
fa <- f_cubica(a); print(fa)
fb <- f_cubica(b); print(fb)
fc <- f_cubica(c); print(fc)

signo_fafc <- sign(fa*fc); print(signo_fafc)
signo_fbfc <- sign(fb*fc); print(signo_fbfc)

# Como fa*fc<0 hacemos la asignación b <- c
b <- c
c <- (a+b)/2; print(c)

fa <- f_cubica(a); print(fa)
fb <- f_cubica(b); print(fb)
fc <- f_cubica(c); print(fc)
signo_fafc <- sign(fa*fc); print(signo_fafc)
signo_fbfc <- sign(fb*fc); print(signo_fbfc)

# Como el signo fue negativo para fb*fc<0
a <- c; print(c)
c <- (a+b)/2; print(c)

fa <- f_cubica(a); print(fa)
fb <- f_cubica(b); print(fb)
fc <- f_cubica(c); print(fc)
signo_fafc <- sign(fa*fc); print(signo_fafc)
signo_fbfc <- sign(fb*fc); print(signo_fbfc)

# Ejemplo 1
# Graficar la funcion f(x)=2x^3-3x^2-11x+6 en [-10,10]
A <- 2
B <- -3
C <- -11
D <- 6

f_secante <- function(x0, x1){
  A <- 2; B <- -3; C <- -11; D <- 6
  fx0 <- A*x0^3 + B*x0^2 + C*x0 + D
  fx1 <- A*x1^3 + B*x1^2 + C*x1 + D
  x2 <- x1 - (fx1 * (x1 - x0) / (fx1 - fx0))
  list(next_x = x2, fx0 = fx0, fx1 = fx1)
}

x0 <- 2.5
x1 <- 3.5
r <- f_secante(x0, x1)
x2 <- r$next_x; x2
mi_error <- abs(x2 - x1); mi_error

x0 <- x1
x1 <- x2
r <- f_secante(x0, x1)
x3 <- r$next_x; x3
mi_error <- abs(x2 - x1); mi_error

x0 <- x1
x1 <- x2
r <- f_secante(x0, x1)
x3 <- r$next_x; x3
fx3 <- A*x3^3 + B*x3^2 + C*x3 + D; fx3
mi_error <- abs(x2 - x1); mi_error

x0 <- x2
x1 <- x3
r <- f_secante(x0, x1)
x4 <- r$next_x; print(x4)
fx4 <- A*x4^3 + B*x4^2 + C*x4 + D; print(fx4)
mi_error <- abs(x4 - x3); print(mi_error)

x0 <- x3
x1 <- x4
r <- f_secante(x0, x1)
x5 <- r$next_x; print(x5)
fx5 <- A*x5^3 + B*x5^2 + C*x5 + D; print(fx5)
mi_error <- abs(x4 - x3); print(mi_error)

x0 <- x4
x1 <- x5
r <- f_secante(x0, x1)
x6 <- r$next_x; print(x6)
fx6 <- A*x6^3 + B*x6^2 + C*x6 + D; print(fx6)
mi_error <- abs(x5 - x4); print(mi_error)

mi_pol <- function(x){A*x^3 + B*x^2 + C*x + D}
x0 <- 2.5; x1 <- 3.5
fx0 <- mi_pol(x0)

f_secante2 <- function(x0, x1){
  fx0 <- mi_pol(x0)
  fx1 <- mi_pol(x1)
  x2 <- x1 - (fx1 * (x1 - x0) / (fx1 - fx0))
  list(next_x = x2)
}

r <- f_secante2(x0, x1)
x2 <- r$next_x; print(x2)
fx2 <- mi_pol(x2)
```

## Discretas

### Generacion de Binominal

```{r}
n1 <- 100
k <- 25
p <- 0.3
```

### n1 = 100

```{r}
mibinominal <- rbinom(n1, k, p)
```

```{r}
plot(mibinominal, col="blue",
     main= "100 VA Binom(k,p)",
     xlab="Num de VA",
     ylab="N(k,p")
```

```{r}
hist(mibinominal, main= "Histograma 100 VA Binom(k,p)",
     col = "orange",
     xlab = "VA generadas",
     ylab = "N(k,p)")
```

### n2 = 500

```{r}
mibinominal <- rbinom(n1, k, p)
```

```{r}
plot(mibinominal, col="blue",
     main= "500 VA Binom(k,p)",
     xlab="Num de VA",
     ylab="N(k,p")
```

```{r}
hist(mibinominal, main= "Histograma 500 VA Binom(k,p)",
     col = "green",
     xlab = "VA generadas",
     ylab = "N(k,p)")
```

### n3 = 1000

```{r}
mibinominal <- rbinom(n1, k, p)
```

```{r}
plot(mibinominal, col="blue",
     main= "1,000 VA Binom(k,p)",
     xlab="Num de VA",
     ylab="N(k,p")
```

```{r}
hist(mibinominal, main= "Histograma 1,000 VA Binom(k,p)",
     col = "violet",
     xlab = "VA generadas",
     ylab = "N(k,p)")
```

### n4 = 5000

```{r}
mibinominal <- rbinom(n1, k, p)
```

```{r}
plot(mibinominal, col="blue",
     main= "5,000 VA Binom(k,p)",
     xlab="Num de VA",
     ylab="N(k,p")
```

```{r}
hist(mibinominal, main= "Histograma 5,000 VA Binom(k,p)",
     col = "brown",
     xlab = "VA generadas",
     ylab = "N(k,p)")
```

### n5 = 10,000

```{r}
mibinominal <- rbinom(n1, k, p)
```

```{r}
plot(mibinominal, col="blue",
     main= "10,000 VA Binom(k,p)",
     xlab="Num de VA",
     ylab="N(k,p")
```

```{r}
hist(mibinominal, main= "Histograma 10,000 VA Binom(k,p)",
     col = "red",
     xlab = "VA generadas",
     ylab = "N(k,p)")
```

## Ahora variamos la p, por un valor de p=0.45

```{r}
n1 <- 100
k <- 25
p <- 0.45
```

### n1 = 100

```{r}
mibinominal <- rbinom(n1, k, p)
```

```{r}
plot(mibinominal, col="blue",
     main= "100 VA Binom(k,p)",
     xlab="Num de VA",
     ylab="N(k,p")
```

```{r}
hist(mibinominal, main= "Histograma 100 VA Binom(k,p)",
     col = "orange",
     xlab = "VA generadas",
     ylab = "N(k,p)")
```

### n2 = 500

```{r}
mibinominal <- rbinom(n1, k, p)
```

```{r}
plot(mibinominal, col="blue",
     main= "500 VA Binom(k,p)",
     xlab="Num de VA",
     ylab="N(k,p")
```

```{r}
hist(mibinominal, main= "Histograma 500 VA Binom(k,p)",
     col = "green",
     xlab = "VA generadas",
     ylab = "N(k,p)")
```

### n3 = 1000

```{r}
mibinominal <- rbinom(n1, k, p)
```

```{r}
plot(mibinominal, col="blue",
     main= "1,000 VA Binom(k,p)",
     xlab="Num de VA",
     ylab="N(k,p")
```

```{r}
hist(mibinominal, main= "Histograma 1,000 VA Binom(k,p)",
     col = "violet",
     xlab = "VA generadas",
     ylab = "N(k,p)")
```

### n4 = 5000

```{r}
mibinominal <- rbinom(n1, k, p)
```

```{r}
plot(mibinominal, col="blue",
     main= "5,000 VA Binom(k,p)",
     xlab="Num de VA",
     ylab="N(k,p")
```

```{r}
hist(mibinominal, main= "Histograma 5,000 VA Binom(k,p)",
     col = "brown",
     xlab = "VA generadas",
     ylab = "N(k,p)")
```

### n5 = 10,000

```{r}
mibinominal <- rbinom(n1, k, p)
```

```{r}
plot(mibinominal, col="blue",
     main= "10,000 VA Binom(k,p)",
     xlab="Num de VA",
     ylab="N(k,p")
```

```{r}
hist(mibinominal, main= "Histograma 10,000 VA Binom(k,p)",
     col = "red",
     xlab = "VA generadas",
     ylab = "N(k,p)")
```

## Ahora variamos p=0.8

```{r}
n1 <- 100
k <- 25
p <- 0.8
```

### n1 = 100

```{r}
mibinominal <- rbinom(n1, k, p)
```

```{r}
plot(mibinominal, col="blue",
     main= "100 VA Binom(k,p)",
     xlab="Num de VA",
     ylab="N(k,p")
```

```{r}
hist(mibinominal, main= "Histograma 100 VA Binom(k,p)",
     col = "orange",
     xlab = "VA generadas",
     ylab = "N(k,p)")
```

### n2 = 500

```{r}
mibinominal <- rbinom(n1, k, p)
```

```{r}
plot(mibinominal, col="blue",
     main= "500 VA Binom(k,p)",
     xlab="Num de VA",
     ylab="N(k,p")
```

```{r}
hist(mibinominal, main= "Histograma 500 VA Binom(k,p)",
     col = "green",
     xlab = "VA generadas",
     ylab = "N(k,p)")
```

### n3 = 1000

```{r}
mibinominal <- rbinom(n1, k, p)
```

```{r}
plot(mibinominal, col="blue",
     main= "1,000 VA Binom(k,p)",
     xlab="Num de VA",
     ylab="N(k,p")
```

```{r}
hist(mibinominal, main= "Histograma 1,000 VA Binom(k,p)",
     col = "violet",
     xlab = "VA generadas",
     ylab = "N(k,p)")
```

### n4 = 5000

```{r}
mibinominal <- rbinom(n1, k, p)
```

```{r}
plot(mibinominal, col="blue",
     main= "5,000 VA Binom(k,p)",
     xlab="Num de VA",
     ylab="N(k,p")
```

```{r}
hist(mibinominal, main= "Histograma 5,000 VA Binom(k,p)",
     col = "brown",
     xlab = "VA generadas",
     ylab = "N(k,p)")
```

### n5 = 10,000

```{r}
mibinominal <- rbinom(n1, k, p)
```

```{r}
plot(mibinominal, col="blue",
     main= "10,000 VA Binom(k,p)",
     xlab="Num de VA",
     ylab="N(k,p")
```

```{r}
hist(mibinominal, main= "Histograma 10,000 VA Binom(k,p)",
     col = "red",
     xlab = "VA generadas",
     ylab = "N(k,p)")
```

## Ahora variamos p=0.95

```{r}
n1 <- 100
k <- 25
p <- 0.95
```

### n1 = 100

```{r}
n1 <- 100
k <- 25
p <- 0.95
mibinominal <- rbinom(n1, k, p)
```

```{r}
plot(mibinominal, col="blue",
     main= "100 VA Binom(k,p)",
     xlab="Num de VA",
     ylab="N(k,p")
```

```{r}
hist(mibinominal, main= "Histograma 100 VA Binom(k,p)",
     col = "orange",
     xlab = "VA generadas",
     ylab = "N(k,p)")
```

### n2 = 500

```{r}
n1 <- 100
k <- 25
p <- 0.95
mibinominal <- rbinom(n1, k, p)
```

```{r}
plot(mibinominal, col="blue",
     main= "500 VA Binom(k,p)",
     xlab="Num de VA",
     ylab="N(k,p")
```

```{r}
hist(mibinominal, main= "Histograma 500 VA Binom(k,p)",
     col = "green",
     xlab = "VA generadas",
     ylab = "N(k,p)")
```

### n3 = 1000

```{r}
n1 <- 100
k <- 25
p <- 0.95
mibinominal <- rbinom(n1, k, p)
```

```{r}
plot(mibinominal, col="blue",
     main= "1,000 VA Binom(k,p)",
     xlab="Num de VA",
     ylab="N(k,p")
```

```{r}
hist(mibinominal, main= "Histograma 1,000 VA Binom(k,p)",
     col = "violet",
     xlab = "VA generadas",
     ylab = "N(k,p)")
```

### n4 = 5000

```{r}
n1 <- 100
k <- 25
p <- 0.95
mibinominal <- rbinom(n1, k, p)
```

```{r}
plot(mibinominal, col="blue",
     main= "5,000 VA Binom(k,p)",
     xlab="Num de VA",
     ylab="N(k,p")
```

```{r}
hist(mibinominal, main= "Histograma 5,000 VA Binom(k,p)",
     col = "brown",
     xlab = "VA generadas",
     ylab = "N(k,p)")
```

### n5 = 10,000

```{r}
n1 <- 100
k <- 25
p <- 0.95
mibinominal <- rbinom(n1, k, p)
```

```{r}
plot(mibinominal, col="blue",
     main= "10,000 VA Binom(k,p)",
     xlab="Num de VA",
     ylab="N(k,p")
```

```{r}
hist(mibinominal, main= "Histograma 10,000 VA Binom(k,p)",
     col = "red",
     xlab = "VA generadas",
     ylab = "N(k,p)")
```

## Hay que comparar los graficos, misma n, distinta p

```{r}
par(mfrow = c(1, 4))
plot(mibinominal, col="blue",
     main= "100 VA N(k,p)")
plot(mibinominal, col="green",
     main= "500 VA N(k,p)")
plot(mibinominal, col="red",
     main= "5000 VA N(k,p)")
     plot(mibinominal, col="red",
     main= "10000 VA N(k,p)")
```

```{r}
par(mfrow = c(1, 4))
hist(mibinominal, main= "Histograma 100 VA N(k,p)",
     col = "orange")
hist(mibinominal, main= "Histograma 1,000 VA N(k,p)",
     col = "purple")
hist(mibinominal, main= "Histograma 5,000 VA N(k,p)",
     col = "green")
hist(mibinominal, main= "Histograma 10,000 VA N(k,p)",
     col = "grey")
```

## Generacion de Poisson 

```{r}
n1 <- 100
milambda <- 0.75
mipoisson <- rpois(n1, milambda)
```

```{r}
etiqueta_Y <- paste0("Poisson(",n1,",", milambda,")")
```

```{r}
mititulo <- paste0(n1, "Va Pois(",n1,",",milambda,")")
plot(mipoisson, col = "blue",
     main= mititulo,
     xlab = "Num de VA",
     ylab = etiqueta_Y)
```

```{r}
mititulo <- paste0("Histograma" ,n1,"VA Pois(",n1,",",milambda,")")
hist(mipoisson, main=mititulo,
     col = "lightgreen",
     xlab = "VA generadas",
     ylab = etiqueta_Y)
```

## Inversa de una matriz
```{r}
A=matrix(c(1,3,-2,1,
 1,4,-1,2,
 0,1,-1,4,
 2,6,1,2),nrow = 4,byrow = TRUE)
(A)
Aorig<- A
```
1)
```{r}
I = diag(4);(I)
```
2)
```{r}
AInv <- cbind(A,I);
(AInv)
```
3)
```{r}
A <- AInv
l21 <- A[2,1]/A[1,1];(l21)
l31 <- A[3,1]/A[1,1];(l31)
l41 <- A[4,1]/A[1,1];(l41)
```
4)
```{r}
A[2,] <- A[2,]-l21*A[1,];
A[3,] <- A[3,]-l31*A[1,];
A[4,] <- A[4,]-l41*A[1,];
(A)
```
5)
```{r}
Atmp <- A[2,]
A[2,] <- A[3,]
A[3,] <- Atmp
(A)
```
6)
```{r}
l32 <- A[3,2]/A[2,2];(l32)
l42 <- A[4,2]/A[2,2];(l42)
```
7)
```{r}
A[3,] <- A[3,]-l32*A[2,];
A[4,] <- A[4,]-l42*A[2,];
(A)
```
8)
```{r}
esc <- 1/A[3,3]
A[3,] <- esc*A[3,]
(A)
```
9)
```{r}
l43 <- A[4,3]/A[3,3];(l43)
```
10)
```{r}
A[4,] <- A[4,]-l43*A[3,];
(A)
```
11)
```{r}
esc <- 1/A[4,4]
A[4,] <- esc*A[4,]
(A)
```
12)
```{r}
l34 <- A[3,4]/A[4,4];(l34); A[3,] <- A[3,]-l34*A[4,]
l24 <- A[2,4]/A[4,4];(l24); A[2,] <- A[2,]-l24*A[4,]
l14 <- A[1,4]/A[4,4];(l14); A[1,] <- A[1,]-l14*A[4,]
(A)
```
13)
```{r}
l23 <- A[2,3]/A[3,3];(l23); A[2,] <- A[2,]-l23*A[3,]
l13 <- A[1,3]/A[3,3];(l13); A[1,] <- A[1,]-l13*A[3,]
(A)
```
14)
```{r}
l12 <- A[1,2]/A[2,2];(l12); A[1,] <- A[1,]-l12*A[2,]
(A)
```
15)
```{r}
AInv <- A[,5:8]; (AInv)
```
16)
```{r}
IdCalc <- Aorig%*%AInv;
(IdCalc)
```
## Factorización LU
### Ejemplo 1
```{r}
A=matrix(c(1,1,1,1,
 2,3,1,5,
 -1,1,-5,3,
 3,1,7,-2),byrow = TRUE,nrow = 4)
(A)
```
```{r}
b=matrix(c(10,31,-2,18),nrow = 4)
(b)
```
```{r}
Ab <- cbind(A,b); (Ab)
```
Los pivotes se definen como $a_{kk}^{(k)}$, luego construimos los
multiplicadores: $l_{i,k}=a_{ik}^{(k)}/a_{kk}^{(k)}$,
$l_{21}=a_{21}/a_{aa}$ y $l_{31}=a_{31}/a_{11}$ y $l_{41}=a_{41}/a_{11}$
```{r}
A <- Ab;
l21 <- A[2,1]/A[1,1];(l21)
l31 <- A[3,1]/A[1,1];(l31)
l41 <- A[4,1]/A[1,1];(l41)
```
Construimos la matriz $U$, donde las entradas $a_{ij}^{(k+1)}=a_{ik}^{(k)}-
l_{ik}\times a_{kj}^{(k)}$
```{r}
A[2,] <- A[2,]-l21*A[1,]; (A[2,])
A[3,] <- A[3,]-l31*A[1,]; (A[3,])
A[4,] <- A[4,]-l41*A[1,]; (A[4,])
```
Es decir la matriz resultante es:
```{r}
(A)
```
entonces el pivote es $A_{22} = 1$, calculemos los $l_{32}$ y $l_{42}$
```{r}
l32 <- A[3,2]/A[2,2];(l32)
l42 <- A[4,2]/A[2,2];(l42)
```
Haciendo cero debajo del pivote
```{r}
A[3,] <- A[3,]-l32*A[2,];(A[3,])
A[4,] <- A[4,]-l42*A[2,];(A[4,])
```
La matriz $A$ queda de la forma:
```{r}
(A)
```
por tanto el pivote es $A_{33}=-2$, y resta calcylar $l_{43}$
```{r}
l43 <- A[4,3]/A[3,3];(l43)
```
haciendo cero debajo del pivote
```{r}
A[4,] <- A[4,]-l43*A[3,];(A[4,])
```
Por lo tanto la matriz $A$ resultante es
```{r}
(A)
```
entonces podemos construir la matriz $L$ con los valores $l_{ij}$
calculados en los pasos anteriores
```{r}
L=diag(4);(L)
```
```{r}
L[2,1] <- l21
L[3,1] <- l31
L[4,1] <- l41
L[3,2] <- l32
L[4,2] <- l42
L[4,3] <- l43
(L)
```
```{r}
U <- A[,1:4];(U)
```
Verifiquemos que efectivamente $A=LU$
```{r}
Acalculada <- L%*%U; (Acalculada)
```
### Ejemplo 2
Apliquemos lo desarrollado para la siguiente matriz $A$
```{r}
A=matrix(c(4,0,1,1,
 3,1,3,1,
 0,1,2,0,
 3,2,4,1),nrow = 4,byrow = TRUE);
(A)
```
```{r}
b=matrix(c(5,6,13,1),nrow = 4);(b)
```
1)
```{r}
Ab <- cbind(A,b)
A <- Ab;
```
2)
```{r}
l21 <- A[2,1]/A[1,1];(l21)
l31 <- A[3,1]/A[1,1];(l31)
l41 <- A[4,1]/A[1,1];(l41)
```
3)
```{r}
A[2,] <- A[2,]-l21*A[1,]; (A[2,])
A[3,] <- A[3,]-l31*A[1,]; (A[3,])
A[4,] <- A[4,]-l41*A[1,]; (A[4,])
```
4)
```{r}
l32 <- A[3,2]/A[2,2];(l32)
l42 <- A[4,2]/A[2,2];(l42)
```
5)
```{r}
A[3,] <- A[3,]-l32*A[2,];(A[3,])
A[4,] <- A[4,]-l42*A[2,];(A[4,])
```
6)
```{r}
l43 <- A[4,3]/A[3,3];(l43)
```
7)
```{r}
A[4,] <- A[4,]-l43*A[3,];(A[4,])
```
8)
```{r}
L=diag(4);(L)
```
9)
```{r}
L[2,1] <- l21
L[3,1] <- l31
L[4,1] <- l41
L[3,2] <- l32
L[4,2] <- l42
L[4,3] <- l43;
(L)
```
10)
```{r}
U <- A[,1:4];(U)
```
11)
```{r}
Acalculada <- L%*%U; (Acalculada)
```
### Ejercicio
Aplicar la factorización $LU$ a la matriz A definida por
```{r}
A=matrix(c(2,3,2,4,
 4,10,-4,0,
 -3,-2,-5,-2,
 -2,4,4,-7),nrow = 4,byrow = TRUE)
(A)
```

```{r}
B=matrix(c(10,31,-2,18),nrow = 4);(B)
```

```{r}
AB <- cbind(A,B); (AB)
```

```{r}
A <- AB;
l21 <- A[2,1]/A[1,1];(l21)
l31 <- A[3,1]/A[1,1];(l31)
l41 <- A[4,1]/A[1,1];(l41)
```

```{r}
A[2,] <- A[2,]-l21*A[1,]; (A[2,])
A[3,] <- A[3,]-l31*A[1,]; (A[3,])
A[4,] <- A[4,]-l41*A[1,]; (A[4,])
```
```{r}
(A)
```

```{r}
l32 <- A[3,2]/A[2,2];(l32)
l42 <- A[4,2]/A[2,2];(l42)
```

```{r}
A[3,] <- A[3,]-l32*A[2,];(A[3,])
A[4,] <- A[4,]-l42*A[2,];(A[4,])
```

```{r}
(A)
```

```{r}
l32 <- A[3,2]/A[2,2];(l32)
l42 <- A[4,2]/A[2,2];(l42)
```

```{r}
A[3,] <- A[3,]-l32*A[2,];(A[3,])
A[4,] <- A[4,]-l42*A[2,];(A[4,])
```

```{r}
(A)
```

```{r}
l43 <- A[4,3]/A[3,3];(l43)
```

```{r}
A[4,] <- A[4,]-l43*A[3,];(A[4,])
```

```{r}
(A)
```

```{r}
L=diag(4);(L)
```

```{r}
L[2,1] <- l21
L[3,1] <- l31
L[4,1] <- l41
L[3,2] <- l32
L[4,2] <- l42
L[4,3] <- l43
(L)
```

```{r}
U <- A[,1:4];(U)
```

```{r}
Acalculada <- L%*%U; (Acalculada)
```

## 05-11
```{r}
rm(list = ls())
```

```{r}
x <- c(1, 2, 4)
y <- c(2, 3, 7)
```

```{r}
A <- cbind(1, x, x^2)
```

```{r}
a <- solve(A, y)
```

```{r}
names(a) <- c("a0", "a1", "a2")
```

```{r}
cat("Coeficientes del polinomio:\n")
print(a)
```

```{r}
cat("\nEl polinomio es:\n")
cat(sprintf("P(x) = %.3f + %.3f*x + %.3f*x^2\n\n", a[1], a[2], a[3]))
```

```{r}
P <- function(x) a[1] + a[2]*x + a[3]*x^2
```

```{r}
valores <- P(x)
resultado <- data.frame(x, y_real = y, y_calculado = valores)
print(resultado)
```

```{r}
plot(x, y, pch = 19, col = "blue",
     main = "Polinomio Interpolador Cuadrático",
     xlab = "x", ylab = "P(x)",
     xlim = c(min(x)-1, max(x)+1),
     ylim = c(min(y)-1, max(y)+2))
curve(P, from = min(x)-1, to = max(x)+1,
      add = TRUE, col = "red", lwd = 2)
legend("topleft", legend = c("Puntos dados", "Polinomio interpolador"),
       col = c("blue", "red"), pch = c(19, NA), lty = c(NA,1))
```

```{r}
if (all(abs(y - valores) < 1e-10)) {
  cat("\n El polinomio pasa exactamente por todos los puntos.\n")
} else {
  cat("\n El polinomio no pasa exactamente por todos los puntos.\n")
}
```

## Gauss-Seidel
```{r}
A <- matrix(c(
  4,-1, 0, 0, 0,
 -1, 4,-1, 0, 0,
  0,-1, 4,-1, 0,
  0, 0,-1, 4,-1,
  0, 0, 0,-1, 4
), nrow = 5, byrow = TRUE)
b <- c(1,2,3,4,5)

```

\[
x_i^{(k+1)} = \frac{1}{a_{ii}}\left( b_i - \sum_{j<i} a_{ij} x_j^{(k+1)} - \sum_{j>i} a_{ij} x_j^{(k)} \right).
\]

```{r}
x <- rep(0,5)  # x^(0) = (0,0,0,0,0)
cat("x^(0) =", paste(sprintf("%.8f", x), collapse=", "), "\n")

```

### Interacion 1

```{r}

# ---- Iteración 1 (escrita a mano, sin bucles) ----
x_old <- x
cat("\nIteración 1\n")

```

```{r}
# Fila 1: 4 x1 - x2 = 1  -> x1 = (1 + x2_old)/4
x[1] <- (b[1] + x_old[2]) / A[1,1]
cat(sprintf("x1^(1) = (1 + %g)/4 = %.8f\n", x_old[2], x[1]))
```

```{r}
# Fila 2: -x1 + 4 x2 - x3 = 2 -> x2 = (2 + x1_new + x3_old)/4
x[2] <- (b[2] + x[1] + x_old[3]) / A[2,2]
cat(sprintf("x2^(1) = (2 + %.8f + %g)/4 = %.8f\n", x[1], x_old[3], x[2]))
```

```{r}
# Fila 3: -x2 + 4 x3 - x4 = 3 -> x3 = (3 + x2_new + x4_old)/4
x[3] <- (b[3] + x[2] + x_old[4]) / A[3,3]
cat(sprintf("x3^(1) = (3 + %.8f + %g)/4 = %.8f\n", x[2], x_old[4], x[3]))
```

```{r}
# Fila 4: -x3 + 4 x4 - x5 = 4 -> x4 = (4 + x3_new + x5_old)/4
x[4] <- (b[4] + x[3] + x_old[5]) / A[4,4]
cat(sprintf("x4^(1) = (4 + %.8f + %g)/4 = %.8f\n", x[3], x_old[5], x[4]))
```

```{r}
# Fila 5: -x4 + 4 x5 = 5 -> x5 = (5 + x4_new)/4
x[5] <- (b[5] + x[4]) / A[5,5]
cat(sprintf("x5^(1) = (5 + %.8f)/4 = %.8f\n", x[4], x[5]))
```

```{r}
# Normas para la iteración 1
r <- b - A %*% x
dx_inf <- max(abs(x - x_old))
cat(sprintf("x^(1) = %s\n", paste(sprintf("%.8f", x), collapse=", ")))
cat(sprintf("||dx||_inf = %.8e | ||r||_inf = %.8e\n", dx_inf, max(abs(r))))
```


 

```{r}
# ---- Iteraciones 2 y 3 (misma idea, con bucle para no repetir tanto) ----
for (k in 2:3) {
  cat(sprintf("\nIteración %d\n", k))
  x_old <- x
  # Recorremos i=1..5 usando el esquema Gauss–Seidel:
  for (i in 1:5) {
    s1 <- if (i > 1) sum(A[i, 1:(i-1)] * x[1:(i-1)]) else 0   # usa x nuevo
    s2 <- if (i < 5) sum(A[i, (i+1):5] * x_old[(i+1):5]) else 0 # usa x viejo
    x[i] <- (b[i] - s1 - s2) / A[i,i]
    # Mostrar el cálculo numérico de esta componente
    cat(sprintf(
      "x%d^(%d) = (b[%d] - s1 - s2)/A[%d,%d] = (%.8f - (%.8f) - (%.8f))/4 = %.8f\n",
      i, k, i, i, i, b[i], s1, s2, x[i]
    ))
  }
  r <- b - A %*% x
  dx_inf <- max(abs(x - x_old))
  cat(sprintf("x^(%d) = %s\n", k, paste(sprintf("%.8f", x), collapse=", ")))
  cat(sprintf("||dx||_inf = %.8e | ||r||_inf = %.8e\n", dx_inf, max(abs(r))))
}
```
usando $x^{(0)}=0$:

\[
\begin{aligned}
x_1^{(1)} &= \frac{1+x_2^{(0)}}{4} = \frac{1+0}{4} = 0.25, \\
x_2^{(1)} &= \frac{2+x_1^{(1)}+x_3^{(0)}}{4} = \frac{2+0.25+0}{4} = 0.5625, \\
x_3^{(1)} &= \frac{3+x_2^{(1)}+x_4^{(0)}}{4} = \frac{3+0.5625+0}{4} = 0.890625, \\
x_4^{(1)} &= \frac{4+x_3^{(1)}+x_5^{(0)}}{4} = \frac{4+0.890625+0}{4} = 1.22265625, \\
x_5^{(1)} &= \frac{5+x_4^{(1)}}{4} = \frac{5+1.22265625}{4} = 1.5556640625.
\end{aligned}
\]

Iteración 2:

\[
\begin{aligned}
x_1^{(2)} &= \frac{1+x_2^{(1)}}{4} = \frac{1+0.5625}{4} = 0.390625, \\
x_2^{(2)} &= \frac{2+x_1^{(2)}+x_3^{(1)}}{4} = \frac{2+0.390625+0.890625}{4} = 0.8203125, \\
x_3^{(2)} &= \frac{3+x_2^{(2)}+x_4^{(1)}}{4} = \frac{3+0.8203125+1.22265625}{4} = 1.2607421875, \\
x_4^{(2)} &= \frac{4+x_3^{(2)}+x_5^{(1)}}{4} = \frac{4+1.2607421875+1.5556640625}{4} = 1.7041015625, \\
x_5^{(2)} &= \frac{5+x_4^{(2)}}{4} = \frac{5+1.7041015625}{4} = 1.676025390625.
\end{aligned}
\]

### Iteración 3:

\[
(x_1,\ldots,x_5)^{(3)} \approx (0.455078125,\;0.9289550781,\;1.4082641602,\;1.7710723877,\;1.6927680969).
\]

Iteración 4:

\[
(x_1,\ldots,x_5)^{(4)} \approx (0.4822387695,\;0.9726257324,\;1.4359245300,\;1.7821731567,\;1.6955432892).
\]

```{r}
# (Opcional) Solución exacta para comparar:
x_exacta <- solve(A, b)
#cat("\nSolución exacta (solve): ", paste(sprintf(\%.8f\", x_exacta), collapse=\", \"), \"\\n\", sep=\"\")

```

### Interacion 2

```{r}
x_old <- x
cat("\nIteración 2\n")
x[1] <- (b[1] + x_old[2]) / A[1,1]
cat(sprintf("x1^(2) = (1 + %g)/4 = %.8f\n", x_old[2], x[1]))
x[2] <- (b[2] + x[1] + x_old[3]) / A[2,2]
cat(sprintf("x2^(2) = (2 + %.8f + %g)/4 = %.8f\n", x[1], x_old[3], x[2]))
x[3] <- (b[3] + x[2] + x_old[4]) / A[3,3]
cat(sprintf("x3^(2) = (3 + %.8f + %g)/4 = %.8f\n", x[2], x_old[4], x[3]))
x[4] <- (b[4] + x[3] + x_old[5]) / A[4,4]
cat(sprintf("x4^(2) = (4 + %.8f + %g)/4 = %.8f\n", x[3], x_old[5], x[4]))
x[5] <- (b[5] + x[4]) / A[5,5]
cat(sprintf("x5^(2) = (5 + %.8f)/4 = %.8f\n", x[4], x[5]))
r <- b - A %*% x
dx_inf <- max(abs(x - x_old))
cat(sprintf("x^(2) = %s\n", paste(sprintf("%.8f", x), collapse=", ")))
cat(sprintf("||dx||_inf = %.8e | ||r||_inf = %.8e\n", dx_inf, max(abs(r))))
```

### Interacion 3

```{r}
x_old <- x
cat("\nIteración 3\n")
x[1] <- (b[1] + x_old[2]) / A[1,1]
cat(sprintf("x1^(3) = (1 + %g)/4 = %.8f\n", x_old[2], x[1]))
x[2] <- (b[2] + x[1] + x_old[3]) / A[2,2]
cat(sprintf("x2^(3) = (2 + %.8f + %g)/4 = %.8f\n", x[1], x_old[3], x[2]))
x[3] <- (b[3] + x[2] + x_old[4]) / A[3,3]
cat(sprintf("x3^(3) = (3 + %.8f + %g)/4 = %.8f\n", x[2], x_old[4], x[3]))
x[4] <- (b[4] + x[3] + x_old[5]) / A[4,4]
cat(sprintf("x4^(3) = (4 + %.8f + %g)/4 = %.8f\n", x[3], x_old[5], x[4]))
x[5] <- (b[5] + x[4]) / A[5,5]
cat(sprintf("x5^(3) = (5 + %.8f)/4 = %.8f\n", x[4], x[5]))
r <- b - A %*% x
dx_inf <- max(abs(x - x_old))
cat(sprintf("x^(3) = %s\n", paste(sprintf("%.8f", x), collapse=", ")))
cat(sprintf("||dx||_inf = %.8e | ||r||_inf = %.8e\n", dx_inf, max(abs(r))))
```

### Interacion 4

```{r}
x_old <- x
cat("\nIteración 4\n")
x[1] <- (b[1] + x_old[2]) / A[1,1]
cat(sprintf("x1^(4) = (1 + %g)/4 = %.8f\n", x_old[2], x[1]))
x[2] <- (b[2] + x[1] + x_old[3]) / A[2,2]
cat(sprintf("x2^(4) = (2 + %.8f + %g)/4 = %.8f\n", x[1], x_old[3], x[2]))
x[3] <- (b[3] + x[2] + x_old[4]) / A[3,3]
cat(sprintf("x3^(4) = (3 + %.8f + %g)/4 = %.8f\n", x[2], x_old[4], x[3]))
x[4] <- (b[4] + x[3] + x_old[5]) / A[4,4]
cat(sprintf("x4^(4) = (4 + %.8f + %g)/4 = %.8f\n", x[3], x_old[5], x[4]))
x[5] <- (b[5] + x[4]) / A[5,5]
cat(sprintf("x5^(4) = (5 + %.8f)/4 = %.8f\n", x[4], x[5]))
r <- b - A %*% x
dx_inf <- max(abs(x - x_old))
cat(sprintf("x^(4) = %s\n", paste(sprintf("%.8f", x), collapse=", ")))
cat(sprintf("||dx||_inf = %.8e | ||r||_inf = %.8e\n", dx_inf, max(abs(r))))
```

### Interacion 5

```{r}
x_old <- x
cat("\nIteración 5\n")
x[1] <- (b[1] + x_old[2]) / A[1,1]
cat(sprintf("x1^(5) = (1 + %g)/4 = %.8f\n", x_old[2], x[1]))
x[2] <- (b[2] + x[1] + x_old[3]) / A[2,2]
cat(sprintf("x2^(5) = (2 + %.8f + %g)/4 = %.8f\n", x[1], x_old[3], x[2]))
x[3] <- (b[3] + x[2] + x_old[4]) / A[3,3]
cat(sprintf("x3^(5) = (3 + %.8f + %g)/4 = %.8f\n", x[2], x_old[4], x[3]))
x[4] <- (b[4] + x[3] + x_old[5]) / A[4,4]
cat(sprintf("x4^(5) = (4 + %.8f + %g)/4 = %.8f\n", x[3], x_old[5], x[4]))
x[5] <- (b[5] + x[4]) / A[5,5]
cat(sprintf("x5^(5) = (5 + %.8f)/4 = %.8f\n", x[4], x[5]))
r <- b - A %*% x
dx_inf <- max(abs(x - x_old))
cat(sprintf("x^(5) = %s\n", paste(sprintf("%.8f", x), collapse=", ")))
cat(sprintf("||dx||_inf = %.8e | ||r||_inf = %.8e\n", dx_inf, max(abs(r))))
```

### Interacion 6

```{r}
x_old <- x
cat("\nIteración 6\n")
x[1] <- (b[1] + x_old[2]) / A[1,1]
cat(sprintf("x1^(6) = (1 + %g)/4 = %.8f\n", x_old[2], x[1]))
x[2] <- (b[2] + x[1] + x_old[3]) / A[2,2]
cat(sprintf("x2^(6) = (2 + %.8f + %g)/4 = %.8f\n", x[1], x_old[3], x[2]))
x[3] <- (b[3] + x[2] + x_old[4]) / A[3,3]
cat(sprintf("x3^(6) = (3 + %.8f + %g)/4 = %.8f\n", x[2], x_old[4], x[3]))
x[4] <- (b[4] + x[3] + x_old[5]) / A[4,4]
cat(sprintf("x4^(6) = (4 + %.8f + %g)/4 = %.8f\n", x[3], x_old[5], x[4]))
x[5] <- (b[5] + x[4]) / A[5,5]
cat(sprintf("x5^(6) = (5 + %.8f)/4 = %.8f\n", x[4], x[5]))
r <- b - A %*% x
dx_inf <- max(abs(x - x_old))
cat(sprintf("x^(6) = %s\n", paste(sprintf("%.8f", x), collapse=", ")))
cat(sprintf("||dx||_inf = %.8e | ||r||_inf = %.8e\n", dx_inf, max(abs(r))))
```

### Interacion 7

```{r}
x_old <- x
cat("\nIteración 7\n")
x[1] <- (b[1] + x_old[2]) / A[1,1]
cat(sprintf("x1^(7) = (1 + %g)/4 = %.8f\n", x_old[2], x[1]))
x[2] <- (b[2] + x[1] + x_old[3]) / A[2,2]
cat(sprintf("x2^(7) = (2 + %.8f + %g)/4 = %.8f\n", x[1], x_old[3], x[2]))
x[3] <- (b[3] + x[2] + x_old[4]) / A[3,3]
cat(sprintf("x3^(7) = (3 + %.8f + %g)/4 = %.8f\n", x[2], x_old[4], x[3]))
x[4] <- (b[4] + x[3] + x_old[5]) / A[4,4]
cat(sprintf("x4^(7) = (4 + %.8f + %g)/4 = %.8f\n", x[3], x_old[5], x[4]))
x[5] <- (b[5] + x[4]) / A[5,5]
cat(sprintf("x5^(7) = (5 + %.8f)/4 = %.8f\n", x[4], x[5]))
r <- b - A %*% x
dx_inf <- max(abs(x - x_old))
cat(sprintf("x^(7) = %s\n", paste(sprintf("%.8f", x), collapse=", ")))
cat(sprintf("||dx||_inf = %.8e | ||r||_inf = %.8e\n", dx_inf, max(abs(r))))
```

### Interacion 8

```{r}
x_old <- x
cat("\nIteración 8\n")
x[1] <- (b[1] + x_old[2]) / A[1,1]
cat(sprintf("x1^(8) = (1 + %g)/4 = %.8f\n", x_old[2], x[1]))
x[2] <- (b[2] + x[1] + x_old[3]) / A[2,2]
cat(sprintf("x2^(8) = (2 + %.8f + %g)/4 = %.8f\n", x[1], x_old[3], x[2]))
x[3] <- (b[3] + x[2] + x_old[4]) / A[3,3]
cat(sprintf("x3^(8) = (3 + %.8f + %g)/4 = %.8f\n", x[2], x_old[4], x[3]))
x[4] <- (b[4] + x[3] + x_old[5]) / A[4,4]
cat(sprintf("x4^(8) = (4 + %.8f + %g)/4 = %.8f\n", x[3], x_old[5], x[4]))
x[5] <- (b[5] + x[4]) / A[5,5]
cat(sprintf("x5^(8) = (5 + %.8f)/4 = %.8f\n", x[4], x[5]))
r <- b - A %*% x
dx_inf <- max(abs(x - x_old))
cat(sprintf("x^(8) = %s\n", paste(sprintf("%.8f", x), collapse=", ")))
cat(sprintf("||dx||_inf = %.8e | ||r||_inf = %.8e\n", dx_inf, max(abs(r))))
```

### Interacion 9

```{r}
x_old <- x
cat("\nIteración 9\n")
x[1] <- (b[1] + x_old[2]) / A[1,1]
cat(sprintf("x1^(9) = (1 + %g)/4 = %.8f\n", x_old[2], x[1]))
x[2] <- (b[2] + x[1] + x_old[3]) / A[2,2]
cat(sprintf("x2^(9) = (2 + %.8f + %g)/4 = %.8f\n", x[1], x_old[3], x[2]))
x[3] <- (b[3] + x[2] + x_old[4]) / A[3,3]
cat(sprintf("x3^(9) = (3 + %.8f + %g)/4 = %.8f\n", x[2], x_old[4], x[3]))
x[4] <- (b[4] + x[3] + x_old[5]) / A[4,4]
cat(sprintf("x4^(9) = (4 + %.8f + %g)/4 = %.8f\n", x[3], x_old[5], x[4]))
x[5] <- (b[5] + x[4]) / A[5,5]
cat(sprintf("x5^(9) = (5 + %.8f)/4 = %.8f\n", x[4], x[5]))
r <- b - A %*% x
dx_inf <- max(abs(x - x_old))
cat(sprintf("x^(9) = %s\n", paste(sprintf("%.8f", x), collapse=", ")))
cat(sprintf("||dx||_inf = %.8e | ||r||_inf = %.8e\n", dx_inf, max(abs(r))))
```

### Interacion 10

```{r}
x_old <- x
cat("\nIteración 10\n")
x[1] <- (b[1] + x_old[2]) / A[1,1]
cat(sprintf("x1^(10) = (1 + %g)/4 = %.8f\n", x_old[2], x[1]))
x[2] <- (b[2] + x[1] + x_old[3]) / A[2,2]
cat(sprintf("x2^(10) = (2 + %.8f + %g)/4 = %.8f\n", x[1], x_old[3], x[2]))
x[3] <- (b[3] + x[2] + x_old[4]) / A[3,3]
cat(sprintf("x3^(10) = (3 + %.8f + %g)/4 = %.8f\n", x[2], x_old[4], x[3]))
x[4] <- (b[4] + x[3] + x_old[5]) / A[4,4]
cat(sprintf("x4^(10) = (4 + %.8f + %g)/4 = %.8f\n", x[3], x_old[5], x[4]))
x[5] <- (b[5] + x[4]) / A[5,5]
cat(sprintf("x5^(10) = (5 + %.8f)/4 = %.8f\n", x[4], x[5]))
r <- b - A %*% x
dx_inf <- max(abs(x - x_old))
cat(sprintf("x^(10) = %s\n", paste(sprintf("%.8f", x), collapse=", ")))
cat(sprintf("||dx||_inf = %.8e | ||r||_inf = %.8e\n", dx_inf, max(abs(r))))
```

# Ejercicios del Portafolio a mano

## Sistema de punto Flotante

```{r}
knitr::include_graphics("sec7-3_ej6.jpg")

```

```{r}
knitr::include_graphics("sec7-3_ej7.jpg")
```

```{r}
knitr::include_graphics("sec7-3_ej7p2.jpg")
```

```{r}
knitr::include_graphics("sec7-3_ej8.jpg")
```

```{r}
knitr::include_graphics("sec7-3_ej8p2.jpg")
```

```{r}
knitr::include_graphics("sec7-4_ej2.jpg")
```

```{r}
knitr::include_graphics("sec7-4_ej2p2.jpg")
```

```{r}
knitr::include_graphics("sec7-4_ej4.jpg")
```

```{r}
knitr::include_graphics("sec7-4_ej4p2.jpg")
```

```{r}
knitr::include_graphics("sec7-5_ej5.jpg")
```

```{r}
knitr::include_graphics("sec7-5_ej5p2.jpg")
```

```{r}
knitr::include_graphics("sec7-5_ej8.jpg")
```

```{r}
knitr::include_graphics("sec7-5_ej8p2.jpg")
```

```{r}
knitr::include_graphics("sec7-6_ej5.jpg")
```

```{r}
knitr::include_graphics("sec7-6_ej8.jpg")
```

```{r}
knitr::include_graphics("sec7-7_ej2.jpg")
```

```{r}
knitr::include_graphics("sec7-7_ej7.jpg")
```

## Sistemas de ecuaciones Lineales  

```{r}
knitr::include_graphics("Biseccion1-3.jpg")
```

```{r}
knitr::include_graphics("Biseccion2_1-3.jpg")
```

```{r}
knitr::include_graphics("Seccion5-1.jpg")
```

```{r}
knitr::include_graphics("Seccion5-1p2.jpg")
```

```{r}
knitr::include_graphics("Secante5-2.jpg")
```

```{r}
knitr::include_graphics("Secante2_5-2.jpg")
```

## Raices de funciones

```{r}
knitr::include_graphics("Notas_Biseccion.jpg")
```

```{r}
knitr::include_graphics("Notas_Biseccion2.jpg")
```

```{r}
knitr::include_graphics("Notas_Secante.jpg")
```

```{r}
knitr::include_graphics("Notas_Newton.jpg")
```

```{r}
knitr::include_graphics("Notas_Punto_Fijo.jpg")
```

## Interpolacion
```{r}
knitr::include_graphics("interpolacion1.jpg")
```

```{r}
knitr::include_graphics("interpolacion2.jpg")
```

```{r}
knitr::include_graphics("interpolacion3.jpg")
```

```{r}
knitr::include_graphics("interpolacion4.jpg")
```

```{r}
knitr::include_graphics("interpolacion5.jpg")
```

```{r}
knitr::include_graphics("interpolacion6.jpg")
```

```{r}
knitr::include_graphics("interpolacion7.jpg")
```

```{r}
knitr::include_graphics("interpolacion8.jpg")
```
