for(i in (k+1):n){
f <- M[i,k]/M[k,k]
M[i,k:ncol(M)] <- M[i,k:ncol(M)] - f*M[k,k:ncol(M)]
}
}
cat("Matriz triangular:\n")
print(round(M,6))
x <- numeric(n)
for(i in n:1){
x[i] <- (M[i,n+1]-sum(M[i,(i+1):n]*x[(i+1):n]))/M[i,i]
}
cat("Solución:\n")
print(round(x,6))
## Ejercicio 7.3.1
# Función: Eliminación Gaussiana con pivoteo parcial
gauss <- function(A, b, tol = 1e-12) {
n <- nrow(A)
M <- cbind(A, b)
cat("Matriz inicial:\n")
print(round(M, 6))
# Eliminación hacia adelante con pivoteo parcial
for (k in 1:(n-1)) {
# Buscar pivote máximo
max_row <- which.max(abs(M[k:n, k])) + k - 1
if (abs(M[max_row, k]) < tol) stop("Pivote cercano a cero")
if (max_row != k) {
M[c(k, max_row), ] <- M[c(max_row, k), ]
cat(sprintf("Intercambio fila %d con fila %d\n", k, max_row))
}
for (i in (k+1):n) {
factor <- M[i, k] / M[k, k]
M[i, k:ncol(M)] <- M[i, k:ncol(M)] - factor * M[k, k:ncol(M)]
cat(sprintf("R%d <- R%d - %.6f*R%d\n", i, i, factor, k))
}
}
cat("Matriz triangular:\n")
print(round(M, 6))
# Sustitución regresiva
x <- numeric(n)
for (i in n:1) {
x[i] <- (M[i, n+1] - sum(M[i, (i+1):n] * x[(i+1):n])) / M[i, i]
}
cat("Solución:\n")
print(round(x, 6))
return(x)
}
# -------------------------
# Ejercicio 7.3.1
cat("\n=== Ejercicio 7.3.1 ===\n")
A <- matrix(c(1, -2, 0.5,
-2, 5, -1.5,
-0.2, 1.75, -1),3,byrow=TRUE)
b <- c(-5,0,10)
x1 <- gauss(A, b)
A <- matrix(c(3, -1, 0, 6,
4, 2, -1, -5,
-5, 1, -3, 0,
0, 10, -4, 7),4,byrow=TRUE)
b <- c(2.3,6.9,-36,-36)
n <- nrow(A)
M <- cbind(A,b)
for(k in 1:(n-1)){
for(i in (k+1):n){
f <- M[i,k]/M[k,k]
M[i,k:ncol(M)] <- M[i,k:ncol(M)] - f*M[k,k:ncol(M)]
}
}
x <- numeric(n)
for(i in n:1){
x[i] <- (M[i,n+1]-sum(M[i,(i+1):n]*x[(i+1):n]))/M[i,i]
}
print(x)
.3
A <- matrix(c(0.003, 59.14,
5.291, -6.13),2,byrow=TRUE)
b <- c(59.17,46.78)
n <- nrow(A)
M <- cbind(A,b)
for(k in 1:(n-1)){
for(i in (k+1):n){
f <- M[i,k]/M[k,k]
M[i,k:ncol(M)] <- M[i,k:ncol(M)] - f*M[k,k:ncol(M)]
}
}
x <- numeric(n)
for(i in n:1){
x[i] <- (M[i,n+1]-sum(M[i,(i+1):n]*x[(i+1):n]))/M[i,i]
}
print(x)
A <- matrix(c(4,2,0,
2,3,1,
0,1,2.5),3,byrow=TRUE)
b <- c(2,-1,3)
n <- nrow(A)
M <- cbind(A,b)
for(k in 1:(n-1)){
for(i in (k+1):n){
f <- M[i,k]/M[k,k]
M[i,k:ncol(M)] <- M[i,k:ncol(M)] - f*M[k,k:ncol(M)]
}
}
x <- numeric(n)
for(i in n:1){
x[i] <- (M[i,n+1]-sum(M[i,(i+1):n]*x[(i+1):n]))/M[i,i]
}
print(x)
A <- matrix(c(3,-0.1,-0.2,
0.1,7,-0.3,
0.3,-0.2,10),3,byrow=TRUE)
b <- c(7.85,-19.3,71.4)
n <- nrow(A)
M <- cbind(A,b)
for(k in 1:(n-1)){
for(i in (k+1):n){
f <- M[i,k]/M[k,k]
M[i,k:ncol(M)] <- M[i,k:ncol(M)] - f*M[k,k:ncol(M)]
}
}
x <- numeric(n)
for(i in n:1){
x[i] <- (M[i,n+1]-sum(M[i,(i+1):n]*x[(i+1):n]))/M[i,i]
}
print(x)
A <- matrix(c(1,2,-1,
2,1,1,
1,-1,2),3,byrow=TRUE)
b <- c(4,5,6)
n <- nrow(A)
M <- cbind(A,b)
for(k in 1:(n-1)){
for(i in (k+1):n){
f <- M[i,k]/M[k,k]
M[i,k:ncol(M)] <- M[i,k:ncol(M)] - f*M[k,k:ncol(M)]
}
}
x <- numeric(n)
for(i in n:1){
x[i] <- (M[i,n+1]-sum(M[i,(i+1):n]*x[(i+1):n]))/M[i,i]
}
print(x)
A <- matrix(c(2,1,-1,
-3,-1,2,
-2,1,2),3,byrow=TRUE)
b <- c(8,-11,-3)
n <- nrow(A)
M <- cbind(A,b)
for(k in 1:(n-1)){
for(i in (k+1):n){
f <- M[i,k]/M[k,k]
M[i,k:ncol(M)] <- M[i,k:ncol(M)] - f*M[k,k:ncol(M)]
}
}
x <- numeric(n)
for(i in n:1){
x[i] <- (M[i,n+1]-sum(M[i,(i+1):n]*x[(i+1):n]))/M[i,i]
}
print(x)
## Ejercicio 7.3.1
gauss <- function(A, b, tol = .Machine$double.eps) {
n <- nrow(A)
M <- cbind(A,b)
cat("Inicial:\n")
print(round(M, 8))
for (k in 1:(n-1)) {
# Pivoteo parcial
max_row <- which.max(abs(M[k:n, k])) + (k-1)
if (max_row != k) {
M[c(k,max_row), ] <- M[c(max_row,k), ]
cat(sprintf("Intercambio R%d R%d\n", k, max_row))
print(round(M, 8))
}
pivot <- M[k,k]
if (abs(pivot) < tol) stop("Pivote cero")
for (i in (k+1):n) {
factor <- M[i,k]/pivot
M[i,k:(n+1)] <- M[i,k:(n+1)] - factor*M[k,k:(n+1)]
cat(sprintf("R%d - %.4g*R%d\n", i, factor, k))
print(round(M, 8))
}
}
cat("Triangular:\n")
print(round(M, 8))
# Sustitución regresiva
x <- numeric(n)
for (i in n:1) {
x[i] <- (M[i,n+1] - sum(M[i,(i+1):n]*x[(i+1):n])) / M[i,i]
}
cat("Solución:\n")
print(round(x, 8))
return(x)
}
# -----------------------------------------
# Ejercicio 7.3.1
A <- matrix(c(1, -2, 0.5,
-2, 5, -1.5,
-0.2, 1.75, -1),3,byrow=TRUE)
b <- c(-5,0,10)
cat("\n=== 7.3.1 ===\n")
gauss(A,b)
A <- matrix(c(3, -1, 0, 6,
4, 2, -1, -5,
-5, 1, -3, 0,
0, 10, -4, 7),4,byrow=TRUE)
b <- c(2.3,6.9,-36,-36)
n <- nrow(A)
M <- cbind(A,b)
for(k in 1:(n-1)){
for(i in (k+1):n){
f <- M[i,k]/M[k,k]
M[i,k:ncol(M)] <- M[i,k:ncol(M)] - f*M[k,k:ncol(M)]
}
}
x <- numeric(n)
for(i in n:1){
x[i] <- (M[i,n+1]-sum(M[i,(i+1):n]*x[(i+1):n]))/M[i,i]
}
print(x)
A <- matrix(c(3, -1, 0, 6,
4, 2, -1, -5,
-5, 1, -3, 0,
0, 10, -4, 7),4,byrow=TRUE)
b <- c(2.3,6.9,-36,-36)
cat("\n=== 7.3.2 ===\n")
gauss(A,b)
cat("\n=== Ejercicio 7.4.2 ===\n")
A2 <- matrix(c(5, -8, 1,
-2, 6, -9,
3, -5, 2), 3, byrow = TRUE)
b2 <- c(-71, 134, -58)
res2 <- gauss(A2, b2)
cat("\n=== Ejercicio 7.4.2 ===\n")
A2 <- matrix(c(5, -8, 1,
-2, 6, -9,
3, -5, 2), 3, byrow = TRUE)
b2 <- c(-71, 134, -58)
res2 <- gauss(A2, b2)
cat("\n=== Ejercicio 7.4.3 ===\n")
A3 <- matrix(c(0.003, 59.14,
5.291, -6.130), 2, byrow = TRUE)
b3 <- c(59.17, 46.7)
res3 <- gauss(A3, b3)
cat("\n=== Ejercicio 7.4.4 ===\n")
A4 <- matrix(c(0, -1, 4, -1,
-1, 4, -1, 0,
-1, 0, -1, 4,
4, -1, 0, 0), 4, byrow = TRUE)
b4 <- c(-1, 2, 4, 10)
res4 <- gauss(A4, b4)
cat("\n=== Ejercicio 7.4.6 ===\n")
A6 <- matrix(c(14, 14, -9, 3, -5,
14, 52, -15, 2, -32,
-9, -15, 36, -5, 16,
3, 2, -5, 47, 49,
-5, 32, 16, 49, 79), 5, byrow = TRUE)
b6 <- c(-15, -100, 106, 329, 463)
res6 <- gauss(A6, b6)
cat("\n=== Ejercicio 7.4.7 ===\n")
A7 <- matrix(c(1/4, 1/5, 1/6,
1/4, 1/3, 1/5,
1/2, 1,   2), 3, byrow = TRUE)
b7 <- c(9, 8, 8)
res7 <- gauss(A7, b7)
.3
A <- matrix(c(0.003, 59.14,
5.291, -6.13),2,byrow=TRUE)
b <- c(59.17,46.78)
cat("\n=== 7.3.3 ===\n")
gauss(A,b)
## Ejercicio 7.3.1
gauss_safe <- function(A, b, tol = 1e-12) {
n <- nrow(A)
M <- cbind(A,b)
for (k in 1:(n-1)) {
# Pivoteo parcial: buscar el máximo en la columna k desde fila k
max_row <- which.max(abs(M[k:n, k])) + (k-1)
if (abs(M[max_row, k]) < tol) stop("Matriz singular o pivote cero")
if (max_row != k) M[c(k,max_row), ] <- M[c(max_row,k), ]
for (i in (k+1):n) {
factor <- M[i,k]/M[k,k]
M[i,k:(n+1)] <- M[i,k:(n+1)] - factor*M[k,k:(n+1)]
}
}
# Sustitución regresiva
x <- numeric(n)
for (i in n:1) {
if (abs(M[i,i]) < tol) stop("Matriz singular en sustitución")
x[i] <- (M[i,n+1] - sum(M[i,(i+1):n]*x[(i+1):n]))/M[i,i]
}
return(x)
}
# Ejemplo 7.3.1 seguro
A <- matrix(c(1, -2, 0.5,
-2, 5, -1.5,
-0.2, 1.75, -1),3,byrow=TRUE)
b <- c(-5,0,10)
gauss_safe(A,b)
## Ejercicio 7.3.1
gauss_safe <- function(A, b, tol = 1e-12) {
n <- nrow(A)
M <- cbind(A,b)
for (k in 1:(n-1)) {
# Pivoteo parcial: buscar el máximo en la columna k desde fila k
max_row <- which.max(abs(M[k:n, k])) + (k-1)
if (abs(M[max_row, k]) < tol) stop("Matriz singular o pivote cero")
if (max_row != k) M[c(k,max_row), ] <- M[c(max_row,k), ]
for (i in (k+1):n) {
factor <- M[i,k]/M[k,k]
M[i,k:(n+1)] <- M[i,k:(n+1)] - factor*M[k,k:(n+1)]
}
}
# Sustitución regresiva
x <- numeric(n)
for (i in n:1) {
if (abs(M[i,i]) < tol) stop("Matriz singular en sustitución")
x[i] <- (M[i,n+1] - sum(M[i,(i+1):n]*x[(i+1):n]))/M[i,i]
}
return(x)
}
# Ejemplo 7.3.1 seguro
A <- matrix(c(1, -2, 0.5,
-2, 5, -1.5,
-0.2, 1.75, -1),3,byrow=TRUE)
b <- c(-5,0,10)
gauss_safe(A,b)
A <- matrix(c(3,-0.1,-0.2,
0.1,7,-0.3,
0.3,-0.2,10),3,byrow=TRUE)
b <- c(7.85,-19.3,71.4)
n <- nrow(A)
M <- cbind(A,b)
for(k in 1:(n-1)){
for(i in (k+1):n){
f <- M[i,k]/M[k,k]
M[i,k:ncol(M)] <- M[i,k:ncol(M)] - f*M[k,k:ncol(M)]
}
}
x <- numeric(n)
for(i in n:1){
x[i] <- (M[i,n+1]-sum(M[i,(i+1):n]*x[(i+1):n]))/M[i,i]
}
print(x)
A <- matrix(c(3, -1, 0, 6,
4, 2, -1, -5,
-5, 1, -3, 0,
0, 10, -4, 7),4,byrow=TRUE)
b <- c(2.3,6.9,-36,-36)
cat("\n=== 7.3.2 ===\n")
gauss(A,b)
A <- matrix(c(3, -1, 0, 6,
4, 2, -1, -5,
-5, 1, -3, 0,
0, 10, -4, 7),4,byrow=TRUE)
b <- c(2.3,6.9,-36,-36)
cat("\n=== 7.3.2 ===\n")
gauss(A,b)
A <- matrix(c(3, -1, 0, 6,
4, 2, -1, -5,
-5, 1, -3, 0,
0, 10, -4, 7),4,byrow=TRUE)
b <- c(2.3,6.9,-36,-36)
cat("\n=== 7.3.2 ===\n")
gauss_safe(A,b)
gauss_seidel <- function(A, b, x_init = NULL, tol = 1e-10, maxit = 200, verbose = TRUE, verbose_every = 1){
n <- nrow(A)
x <- if(is.null(x_init)) rep(0, n) else x_init
if(verbose) cat("Vector inicial x:\n"); print(round(x,8))
for(k in 1:maxit){
x_old <- x
for(i in 1:n){
if(abs(A[i,i]) < 1e-15){
stop(sprintf("Cuidado! División por cero en fila %d.", i))
}
s1 <- if(i>1) sum(A[i,1:(i-1)]*x[1:(i-1)]) else 0
s2 <- if(i<n) sum(A[i,(i+1):n]*x_old[(i+1):n]) else 0
x[i] <- (b[i]-s1-s2)/A[i,i]
if(verbose & (k %% verbose_every == 0)){
cat(sprintf("Actualizando x[%d] = %.8f\n", i, x[i]))
}
}
err <- sqrt(sum((x-x_old)^2))
if(is.na(err)){
cat(sprintf("Error en iteración %d: NA detectado. Posible no convergencia.\n", k))
break
}
if(verbose & (k %% verbose_every == 0)){
cat(sprintf("Error en iteración %d: %.12f\n", k, err))
}
if(err<tol){
if(verbose) cat("¡Convergencia alcanzada!\n")
break
}
}
if(verbose) {
cat("\nResultado final x:\n")
print(round(x,8))
resid <- A %*% x - b
cat("\nChequeando residuo (Ax-b):\n")
print(round(resid,8))
} else {
resid <- A %*% x - b
}
list(x=x, residual=resid)
}
# -------------------------
# Ejercicios 7.6 con pivoteo parcial seguro
# 7.6.1
A <- matrix(c(3,-0.2,-0.5,
0.1,7,0.4,
0.4,-0.1,10),3,byrow=TRUE)
b <- c(8,-19.5,72.4)
cat("=== Ejercicio 7.6.1 ===\n")
res <- gauss_seidel(A,b, verbose=TRUE)
# 7.6.2 - simplificado para no saturar
A <- matrix(c(-5,1.4,-2.7,
0.7,-2.5,15,
3.3,-11,4.4),3,byrow=TRUE)
b <- c(94.2,-6,-27.5)
cat("\n=== Ejercicio 7.6.2 (simplificado) ===\n")
res <- gauss_seidel(A,b, verbose=TRUE, verbose_every=5)
# 7.6.3
A <- matrix(c(3,-0.5,0.6,
0.3,-4,-1,
-0.7,2,7),3,byrow=TRUE)
b <- c(5.24,-0.387,14.803)
cat("\n=== Ejercicio 7.6.3 ===\n")
res <- gauss_seidel(A,b, verbose=TRUE)
# 7.6.4
A <- matrix(c(5,-0.2,1,
0.1,3,-0.5,
-0.3,1,-7),3,byrow=TRUE)
b <- c(1.5,-2.7,9.5)
cat("\n=== Ejercicio 7.6.4 ===\n")
res <- gauss_seidel(A,b, verbose=TRUE)
# 7.6.5
A <- matrix(c(0,-3,7,
1,2,-1,
12,2,2),3,byrow=TRUE)
b <- c(2,3,6)
cat("\n=== Ejercicio 7.6.5 ===\n")
res <- gauss_seidel(A,b, verbose=TRUE)
A <- matrix(c(3,-0.2,-0.5,
0.1,7,0.4,
0.4,-0.1,10),3,byrow=TRUE)
b <- c(8,-19.5,72.4)
cat("=== Ejercicio 7.6.1 ===\n")
res <- gauss_seidel(A,b, verbose=TRUE)
A <- matrix(c(-5,1.4,-2.7,
0.7,-2.5,15,
3.3,-11,4.4),3,byrow=TRUE)
b <- c(94.2,-6,-27.5)
cat("\n=== Ejercicio 7.6.2 (iteración de 5 en 5) ===\n")
res <- gauss_seidel(A,b, verbose=TRUE, verbose_every=5)
A <- matrix(c(3,-0.5,0.6,
0.3,-4,-1,
-0.7,2,7),3,byrow=TRUE)
b <- c(5.24,-0.387,14.803)
cat("\n=== Ejercicio 7.6.3 ===\n")
res <- gauss_seidel(A,b, verbose=TRUE)
A <- matrix(c(5,-0.2,1,
0.1,3,-0.5,
-0.3,1,-7),3,byrow=TRUE)
b <- c(1.5,-2.7,9.5)
cat("\n=== Ejercicio 7.6.4 ===\n")
res <- gauss_seidel(A,b, verbose=TRUE)
A <- matrix(c(0.151,2.11,30.75,
0.64,1.21,2.05,
3.21,1.53,1.04),3,byrow=TRUE)
b <- c(-26.38,1.01,5.23)
cat("\n=== Ejercicio 7.6.6 (iteración de 5 en 5) ===\n")
res <- gauss_seidel(A,b, verbose=TRUE, verbose_every=5)
A <- matrix(c(0,-3,7,
1,2,-1,
12,2,2),3,byrow=TRUE)
b <- c(2,3,6)
cat("\n=== Ejercicio 7.6.5 (iteración de 5 en 5, reordenado) ===\n")
res <- gauss_seidel(A,b, verbose=TRUE, verbose_every=5)
A <- matrix(c(0,-3,7,
1,2,-1,
12,2,2),3,byrow=TRUE)
b <- c(2,3,6)
cat("\n=== Ejercicio 7.6.5 (iteración de 5 en 5, reordenado) ===\n")
res <- gauss_seidel(A,b, verbose=TRUE, verbose_every=5)
A <- matrix(c(0,-3,7,
1,2,-1,
12,2,2),3,byrow=TRUE)
b <- c(2,3,6)
cat("\n=== Ejercicio 7.6.5 (iteración de 5 en 5) ===\n")
res <- gauss_seidel(A,b, verbose=TRUE, verbose_every=5)
## Ejercicio 7.7 - sistema 3x3
A <- matrix(c(1,2,-1,
2,1,1,
1,-1,2),3,byrow=TRUE)
b <- c(3,4,5)
n <- nrow(A)
M <- cbind(A,b)
for(i in 1:n){
M[i,] <- M[i,]/M[i,i]
for(j in 1:n){
if(j != i){
M[j,] <- M[j,]-M[j,i]*M[i,]
}
}
}
sol <- M[,n+1]
print(sol)
A <- matrix(c(10,2,-1,0,
1,20,-2,3,
-2,1,30,0,
1,2,3,20),4,byrow=TRUE)
b <- c(26,-15,53,47)
cat("\n=== Ejercicio 7.7.1 ===\n")
res <- jacobi(A,b, verbose=TRUE)
